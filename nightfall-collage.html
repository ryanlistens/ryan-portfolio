<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no, viewport-fit=cover">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <title>NIGHTFALL - A Collage Noir</title>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Special+Elite&family=Playfair+Display:wght@700;900&display=swap');
        *{margin:0;padding:0;box-sizing:border-box;-webkit-tap-highlight-color:transparent}
        html,body{width:100%;height:100%;overflow:hidden;background:#080706;font-family:'Special Elite',monospace}
        #game{position:fixed;top:0;left:0;width:100%;height:100%;overflow:hidden;cursor:crosshair;touch-action:none}

        /* === GILLIAM ANIMATIONS === */
        @keyframes gi{0%,100%{transform:rotate(0) translateY(0)}12%{transform:rotate(.7deg) translateY(-2px)}37%{transform:rotate(-.5deg) translateY(1px)}62%{transform:rotate(-.8deg) translateY(-1px)}84%{transform:rotate(.4deg) translateY(0)}}
        @keyframes gw{0%,100%{transform:rotate(-2deg) translateY(0)}25%{transform:rotate(3deg) translateY(-6px)}50%{transform:rotate(-2deg) translateY(0)}75%{transform:rotate(3deg) translateY(-6px)}}
        @keyframes gt{0%,100%{transform:rotate(0) scale(1)}12%{transform:rotate(-2deg) scale(1.03)}28%{transform:rotate(2deg) scale(.97)}44%{transform:rotate(-1.5deg) scale(1.02)}62%{transform:rotate(1.5deg) scale(.98)}78%{transform:rotate(-.5deg) scale(1.01)}}
        @keyframes gs{0%,100%{transform:rotate(-.3deg)}50%{transform:rotate(.3deg)}}
        @keyframes nb{0%,18%,22%,25%,53%,57%,100%{opacity:1}20%,24%,55%{opacity:.3}}
        @keyframes smk{0%{transform:translateY(0) scale(1) rotate(0);opacity:.5}40%{transform:translateY(-30px) scale(1.4) rotate(15deg);opacity:.25}100%{transform:translateY(-70px) scale(2.2) rotate(35deg);opacity:0}}
        @keyframes fl{0%,100%{opacity:.7}50%{opacity:1}}
        @keyframes dr{0%,100%{transform:translateY(0) rotate(0)}50%{transform:translateY(-3px) rotate(.4deg)}}
        @keyframes pu{0%,100%{opacity:.3}50%{opacity:1}}
        @keyframes se{0%{opacity:0;transform:scale(1.04) rotate(-.4deg)}100%{opacity:1;transform:scale(1) rotate(0)}}
        @keyframes fadeIn{0%{opacity:0}100%{opacity:1}}

        /* === CUTOUT SYSTEM === */
        .cut{position:absolute;overflow:hidden}
        .cut img{width:100%;height:100%;object-fit:cover;display:block}
        .cut.torn{filter:grayscale(55%) contrast(1.3) sepia(25%) brightness(.85);box-shadow:3px 4px 0 rgba(0,0,0,.7),-1px -1px 0 rgba(220,210,190,.08)}
        .cut.framed{filter:grayscale(50%) contrast(1.25) sepia(30%) brightness(.8);border:5px solid #e8e0d0;box-shadow:4px 5px 15px rgba(0,0,0,.7),inset 0 0 20px rgba(0,0,0,.3)}
        .cut.rough{filter:grayscale(60%) contrast(1.35) sepia(20%) brightness(.75);box-shadow:2px 3px 1px rgba(0,0,0,.6),-1px -2px 0 rgba(0,0,0,.3)}
        .cut.pasted{filter:grayscale(40%) contrast(1.2) sepia(35%);box-shadow:2px 3px 8px rgba(0,0,0,.5);border:2px solid rgba(200,190,170,.15)}

        /* === SCENES === */
        .scene{position:absolute;width:100%;height:100%;display:none;animation:se 1s ease-out}
        .scene.active{display:block}

        /* === STREET === */
        #sc-street{background:linear-gradient(170deg,#050608,#0a0c12 35%,#0e1018)}
        .photo-bg{position:absolute;top:0;left:-5%;width:110%;height:78%;overflow:hidden;opacity:.3}
        .photo-bg img{width:100%;height:100%;object-fit:cover;object-position:center 30%;filter:grayscale(70%) contrast(1.5) brightness(.5) sepia(15%)}
        .bg-fade{position:absolute;top:0;left:0;width:100%;height:100%;background:linear-gradient(to bottom,rgba(5,6,8,.2) 0%,transparent 15%,rgba(5,6,8,.1) 40%,rgba(5,6,8,.5) 60%,rgba(5,6,8,.92) 78%,#080a10 88%);pointer-events:none}
        .bg-side{position:absolute;top:0;left:0;width:100%;height:100%;background:linear-gradient(to right,rgba(5,6,8,.6) 0%,transparent 15%,transparent 85%,rgba(5,6,8,.6) 100%);pointer-events:none}
        .moon{position:absolute;top:4%;right:14%;width:65px;height:65px;border-radius:50%;background:radial-gradient(circle at 35% 30%,#fff8e0,#f0e8c8 30%,#d8c8a0 55%,#a09070 75%,transparent);box-shadow:0 0 40px rgba(255,250,200,.25),0 0 80px rgba(255,250,200,.1);animation:dr 12s ease-in-out infinite}
        .bldg-layer{position:absolute;bottom:20%;left:0;width:100%;height:60%;pointer-events:none}
        .bs{position:absolute;bottom:0;background:#06060a;animation:gs 10s ease-in-out infinite}
        .b1{left:0;width:18%;height:80%;clip-path:polygon(0 100%,0 25%,5% 25%,5% 12%,15% 12%,15% 0,30% 0,30% 8%,45% 8%,45% 18%,55% 18%,55% 0,68% 0,68% 15%,80% 15%,80% 8%,100% 8%,100% 100%)}
        .b2{left:17%;width:22%;height:72%;clip-path:polygon(0 100%,0 30%,8% 30%,8% 10%,20% 10%,20% 0,40% 0,40% 5%,55% 5%,55% 15%,65% 15%,65% 5%,80% 5%,80% 20%,100% 20%,100% 100%);animation-delay:-3s}
        .b3{left:38%;width:25%;height:82%;clip-path:polygon(0 100%,0 22%,12% 22%,12% 8%,25% 8%,25% 0,42% 0,42% 3%,55% 3%,55% 12%,70% 12%,70% 0,85% 0,85% 18%,100% 18%,100% 100%);animation-delay:-5s}
        .b4{left:62%;width:20%;height:68%;clip-path:polygon(0 100%,0 25%,15% 25%,15% 8%,35% 8%,35% 0,55% 0,55% 12%,70% 12%,70% 20%,100% 20%,100% 100%);animation-delay:-7s}
        .b5{left:80%;width:21%;height:75%;clip-path:polygon(0 100%,0 18%,10% 18%,10% 5%,30% 5%,30% 0,50% 0,50% 8%,65% 8%,65% 0,80% 0,80% 12%,100% 12%,100% 100%);animation-delay:-2s}
        .w{position:absolute;background:rgba(255,215,130,.65);box-shadow:0 0 8px rgba(255,200,100,.3);animation:fl 4s ease-in-out infinite}
        .neon{position:absolute;font-weight:bold;z-index:10;cursor:pointer;user-select:none}
        .nr{font-family:sans-serif;font-size:clamp(20px,4.5vw,32px);color:#ff2020;text-shadow:0 0 7px #ff2020,0 0 15px #ff2020,0 0 35px #f00,0 0 60px #c00;animation:nb 3s ease-in-out infinite}
        .nbl{font-family:sans-serif;font-size:clamp(14px,3vw,24px);color:#4499ff;text-shadow:0 0 6px #4499ff,0 0 14px #4499ff,0 0 30px #26d;animation:nb 3.5s ease-in-out infinite;animation-delay:-1.2s}
        .na{font-family:cursive;font-size:clamp(12px,2.5vw,20px);color:#ffaa30;text-shadow:0 0 6px #ffaa30,0 0 12px #f81;animation:nb 4s ease-in-out infinite;animation-delay:-2.5s}
        .ng{font-family:sans-serif;font-size:clamp(8px,1.8vw,14px);color:#44dd66;text-shadow:0 0 5px #44dd66,0 0 12px #2a4;animation:nb 3.2s ease-in-out infinite;animation-delay:-.8s}
        .sp{font-family:'Special Elite',monospace;font-size:clamp(6px,1.4vw,10px);color:#b0a080;letter-spacing:3px;text-shadow:0 0 4px rgba(180,160,120,.3)}
        .nr-ref{position:absolute;bottom:2%;filter:blur(3px);opacity:.4;animation:nb 3s ease-in-out infinite;pointer-events:none}
        .st-ground{position:absolute;bottom:0;left:0;width:100%;height:22%;background:linear-gradient(to bottom,#141418,#0e0e12 30%,#0a0a0e)}
        .sidewalk{position:absolute;top:0;left:0;width:100%;height:18%;background:linear-gradient(to bottom,#202028,#1a1a20);border-top:2px solid #2a2a32}
        .lamp{position:absolute;bottom:20%;z-index:8;animation:gi 12s ease-in-out infinite}
        .lp{width:4px;height:140px;background:linear-gradient(to right,#0a0a0a,#1a1a1a,#0a0a0a);margin:0 auto}
        .lh{width:28px;height:18px;background:#0e0e0e;border-radius:3px 3px 0 0;margin:0 auto;position:relative}
        .lh::after{content:'';position:absolute;bottom:-2px;left:50%;transform:translateX(-50%);width:14px;height:6px;background:rgba(255,240,200,.9);border-radius:50%;box-shadow:0 0 8px rgba(255,240,200,.6)}
        .lpool{position:absolute;top:-60px;left:50%;transform:translateX(-50%);width:200px;height:220px;background:radial-gradient(ellipse at top,rgba(255,240,200,.12),rgba(255,240,200,.04) 35%,transparent 65%);pointer-events:none}
        .car-cut{position:absolute;bottom:3%;left:52%;width:clamp(130px,26vw,220px);height:clamp(55px,11vw,90px);z-index:6;cursor:pointer;animation:gi 7s ease-in-out infinite;animation-delay:-2s}
        .car-cut img{width:100%;height:100%;object-fit:contain;filter:brightness(.35) contrast(1.4) grayscale(65%) sepia(15%);transition:filter .3s}
        .car-cut:hover img{filter:brightness(.5) contrast(1.3) grayscale(45%) sepia(15%)}

        /* === CHARACTERS === */
        .ch{position:absolute;z-index:50;transform-origin:bottom center;cursor:pointer}
        .ch.idle{animation:gi 4s ease-in-out infinite}
        .ch.walking{animation:gw .35s ease-in-out infinite}
        .ch.talking{animation:gt .25s ease-in-out infinite}
        .ch .pb{position:absolute;top:0;left:0;width:100%;height:100%;overflow:hidden}
        .ch .pb img{width:100%;height:100%;object-fit:cover;display:block}
        .ch .cshadow{position:absolute;bottom:-5px;left:5%;width:90%;height:10px;background:rgba(0,0,0,.6);border-radius:50%;filter:blur(4px)}
        #player{width:clamp(48px,8vw,62px);height:clamp(130px,22vw,170px);z-index:100}
        #player .pb img{object-position:center 10%;filter:brightness(.55) contrast(1.5) grayscale(50%) sepia(20%)}
        .viv{width:clamp(40px,7vw,52px);height:clamp(120px,20vw,155px)}
        .viv .pb img{object-position:center 8%;filter:brightness(.5) contrast(1.4) grayscale(45%) sepia(25%)}
        .csmoke{position:absolute;top:28%;right:-15%;width:10px;height:10px;background:rgba(180,175,165,.4);border-radius:50%;animation:smk 2.8s ease-out infinite}
        .csmoke:nth-child(2){animation-delay:-.9s;width:8px;height:8px}
        .csmoke:nth-child(3){animation-delay:-1.8s;width:6px;height:6px}
        .ipip{position:absolute;top:-20px;left:50%;transform:translateX(-50%);font-size:14px;color:#c4a35a;opacity:0;transition:opacity .3s;animation:dr 1.5s ease-in-out infinite;pointer-events:none}
        .ch:hover .ipip,.car-cut:hover .ipip,.clue:hover .ipip,.hotspot:hover .ipip{opacity:1}

        /* === CLUES === */
        .clue{position:absolute;cursor:pointer;z-index:30;animation:dr 3s ease-in-out infinite;transition:transform .2s,filter .2s}
        .clue:hover{transform:scale(1.12);filter:brightness(1.4) drop-shadow(0 0 10px rgba(255,200,100,.3))}
        .cl-paper{bottom:7%;left:20%;width:42px;height:52px;background:#ddd8c8;transform:rotate(-3deg);box-shadow:2px 3px 8px rgba(0,0,0,.6);padding:4px;overflow:hidden}
        .pt{font-family:'Playfair Display',serif;font-size:5px;font-weight:900;color:#1a1a1a;text-align:center;border-bottom:1px solid #333;padding-bottom:2px;margin-bottom:2px}
        .ph{font-family:serif;font-size:4px;font-weight:bold;color:#2a2a2a;line-height:1.3}
        .pp{font-size:3px;color:#555;line-height:1.2;margin-top:2px}
        .cl-match{bottom:5%;left:70%;width:24px;height:30px;background:linear-gradient(to bottom,#8b0000,#5a0000);border-radius:2px 2px 0 0;box-shadow:1px 2px 5px rgba(0,0,0,.7);animation-delay:-1.5s;display:flex;align-items:center;justify-content:center}
        .mt{font-size:3px;color:#d4a030;text-align:center;line-height:1.2;font-family:sans-serif;font-weight:bold}
        .door-zone{position:absolute;cursor:pointer;z-index:20;transition:box-shadow .3s}
        .door-zone::after{content:attr(data-label);position:absolute;bottom:-18px;left:50%;transform:translateX(-50%);font-size:8px;color:#8a7a5a;letter-spacing:2px;opacity:0;transition:opacity .3s;white-space:nowrap;font-family:'Special Elite',monospace}
        .door-zone:hover::after{opacity:1}
        .door-zone:hover{box-shadow:0 0 30px rgba(255,200,100,.25)}

        /* === BAR INTERIOR === */
        #sc-bar{background:#06040a}
        .bar-bg{position:absolute;top:0;left:0;width:100%;height:100%}
        /* Vintage wallpaper pattern */
        .bar-wallpaper{position:absolute;top:0;left:0;width:100%;height:58%;background:#18121a;background-image:repeating-linear-gradient(0deg,transparent,transparent 24px,rgba(80,50,30,.08) 24px,rgba(80,50,30,.08) 25px),repeating-linear-gradient(90deg,transparent,transparent 24px,rgba(80,50,30,.06) 24px,rgba(80,50,30,.06) 25px)}
        /* Wainscoting below */
        .bar-wains{position:absolute;top:42%;left:0;width:100%;height:16%;background:linear-gradient(to bottom,#201518,#18100f);border-top:3px solid #3a2520;background-image:repeating-linear-gradient(90deg,transparent,transparent 30px,rgba(60,40,30,.12) 30px,rgba(60,40,30,.12) 32px)}
        /* Mirror with smoky reflection */
        .bar-mirror{position:absolute;top:5%;left:15%;width:70%;height:36%;background:linear-gradient(170deg,rgba(20,15,25,.9),rgba(30,25,35,.7) 30%,rgba(15,12,20,.85) 60%,rgba(25,20,30,.9));border:6px solid #2a1a15;box-shadow:inset 0 0 40px rgba(0,0,0,.6),0 4px 20px rgba(0,0,0,.5)}
        .mirror-shine{position:absolute;top:5%;left:15%;width:70%;height:36%;background:linear-gradient(135deg,rgba(255,250,240,.03) 0%,transparent 40%,transparent 60%,rgba(255,250,240,.02) 100%);pointer-events:none}
        /* Shelf system */
        .bar-shelf{position:absolute;height:4px;background:linear-gradient(to bottom,#4a3525,#2a1a12);box-shadow:0 2px 6px rgba(0,0,0,.5)}
        .bar-shelf::after{content:'';position:absolute;bottom:-2px;left:0;width:100%;height:2px;background:#1a0e08}
        /* Amber pendant lights */
        .pendant{position:absolute;top:0;z-index:5}
        .pendant-cord{width:2px;height:28px;background:#2a2020;margin:0 auto}
        .pendant-shade{width:24px;height:14px;background:linear-gradient(to bottom,#4a3a20,#3a2a15);border-radius:0 0 12px 12px;margin:0 auto;position:relative}
        .pendant-shade::after{content:'';position:absolute;bottom:0;left:50%;transform:translateX(-50%);width:8px;height:4px;background:rgba(255,210,120,.9);border-radius:50%;box-shadow:0 0 12px rgba(255,200,100,.4),0 0 40px rgba(255,200,100,.15)}
        .pendant-pool{position:absolute;top:42px;left:50%;transform:translateX(-50%);width:80px;height:200px;background:radial-gradient(ellipse at top,rgba(255,200,100,.06),transparent 60%);pointer-events:none}
        /* Bar counter - thick mahogany */
        .bar-counter{position:absolute;bottom:22%;left:2%;width:96%;height:14%;background:linear-gradient(to bottom,#4a3018,#3a2010,#2a1508);border-top:4px solid #5a3a20;box-shadow:0 4px 20px rgba(0,0,0,.5);background-image:repeating-linear-gradient(90deg,transparent,transparent 8px,rgba(80,50,20,.08) 8px,rgba(80,50,20,.08) 9px)}
        .counter-edge{position:absolute;bottom:22%;left:2%;width:96%;height:4px;background:linear-gradient(to bottom,#5a3a20,#3a2010);border-radius:0 0 2px 2px}
        .counter-shine{position:absolute;bottom:32%;left:5%;width:90%;height:3px;background:linear-gradient(to right,transparent,rgba(255,220,160,.06),rgba(255,220,160,.04),transparent);pointer-events:none}
        /* Bar items on counter */
        .bar-ashtray{position:absolute;width:18px;height:6px;background:rgba(80,80,80,.7);border-radius:50%;box-shadow:inset 0 -2px 3px rgba(0,0,0,.3)}
        .bar-coaster{position:absolute;width:14px;height:14px;border-radius:50%;background:#d8d0c0;opacity:.2}
        .bar-napkin{position:absolute;width:16px;height:16px;background:#e8e0d0;opacity:.12;transform:rotate(5deg)}
        /* Stools - leather and chrome */
        .stool{position:absolute;bottom:10%;animation:gi 8s ease-in-out infinite}
        .stool-top{width:32px;height:10px;background:radial-gradient(ellipse,#3a2218,#2a1508);border-radius:50%;border:1px solid #4a3525}
        .stool-leg{width:3px;height:50px;background:linear-gradient(to right,#555,#888,#555);margin:0 auto}
        .stool-base{width:24px;height:3px;background:#555;border-radius:1px;margin:0 auto}
        /* Floor - dark hardwood */
        .bar-floor{position:absolute;bottom:0;left:0;width:100%;height:14%;background:linear-gradient(to bottom,#14100c,#0c0808);background-image:repeating-linear-gradient(90deg,transparent,transparent 16px,rgba(40,30,20,.1) 16px,rgba(40,30,20,.1) 17px)}
        .floor-shine{position:absolute;bottom:0;left:0;width:100%;height:14%;background:radial-gradient(ellipse at 50% 0%,rgba(255,200,100,.03),transparent 50%);pointer-events:none}
        /* Neon beer sign */
        .beer-sign{position:absolute;top:3%;right:8%;padding:6px 12px;border:2px solid #ff8800;border-radius:3px;font-family:cursive;font-size:clamp(12px,3vw,18px);color:#ffaa33;text-shadow:0 0 8px #ffaa33,0 0 16px #f81,0 0 30px rgba(255,136,0,.3);animation:nb 4s ease-in-out infinite;transform:rotate(-3deg);box-shadow:0 0 15px rgba(255,136,0,.15)}
        /* Smoke haze */
        .bar-haze{position:absolute;top:0;left:0;width:100%;height:100%;background:linear-gradient(to bottom,rgba(60,50,40,.08),transparent 30%,transparent 70%,rgba(40,30,20,.05));pointer-events:none;z-index:4}
        /* Bartender - detailed */
        .bart{width:clamp(50px,9vw,65px);height:clamp(120px,20vw,155px)}
        .bart-head{position:absolute;top:0;left:50%;transform:translateX(-50%);width:55%;height:18%;z-index:3}
        .bart-skull{width:100%;height:80%;background:linear-gradient(to bottom,#b89870,#a08058);border-radius:45% 45% 40% 40%}
        .bart-hair{position:absolute;top:0;left:5%;width:90%;height:40%;background:#2a2018;border-radius:50% 50% 0 0}
        .bart-eyes{position:absolute;top:45%;left:20%;width:60%;height:8%;display:flex;justify-content:space-between}
        .bart-eye{width:6px;height:6px;background:#1a1a1a;border-radius:50%}
        .bart-nose{position:absolute;top:58%;left:50%;transform:translateX(-50%);width:5px;height:6px;background:#a07848;border-radius:0 0 2px 2px}
        .bart-mouth{position:absolute;top:72%;left:30%;width:40%;height:3px;background:#8a5a3a;border-radius:0 0 3px 3px}
        .bart-body{position:absolute;top:18%;left:10%;width:80%;height:82%;background:linear-gradient(to bottom,#1a1818,#0e0e0e);clip-path:polygon(15% 0%,85% 0%,95% 8%,100% 30%,95% 100%,5% 100%,0% 30%,5% 8%)}
        .bart-vest{position:absolute;top:18%;left:15%;width:70%;height:35%;background:linear-gradient(to bottom,#2a1a15,#1a0e0a)}
        .bart-shirt{position:absolute;top:18%;left:25%;width:50%;height:30%;background:linear-gradient(to bottom,#d8d0c0,#c8c0b0)}
        .bart-apron{position:absolute;top:45%;left:18%;width:64%;height:55%;background:linear-gradient(to bottom,#e0d8c8,#d0c8b8);border-top:2px solid #b0a898}
        .bart-arm{position:absolute;top:25%;width:18%;height:35%;background:#1a1818;border-radius:5px}
        .bart-arm-l{left:-5%;transform:rotate(8deg)}
        .bart-arm-r{right:-5%;transform:rotate(-8deg)}
        .bart-towel{position:absolute;top:35%;right:-15%;width:35%;height:6px;background:#d0c8c0;transform:rotate(-20deg);border-radius:1px;box-shadow:0 1px 2px rgba(0,0,0,.3)}

        /* === PI OFFICE === */
        #sc-office{background:#0e0c08}
        .off-wall{position:absolute;top:0;left:0;width:100%;height:72%;background:linear-gradient(to bottom,#28221a,#1e1810);background-image:repeating-linear-gradient(90deg,transparent,transparent 40px,rgba(60,50,35,.06) 40px,rgba(60,50,35,.06) 41px)}
        .off-molding{position:absolute;top:52%;left:0;width:100%;height:3px;background:#3a3020;box-shadow:0 1px 3px rgba(0,0,0,.3)}
        .off-baseboard{position:absolute;top:70%;left:0;width:100%;height:3px;background:#2a2015}
        .off-win{position:absolute;top:6%;right:10%;width:clamp(140px,28vw,210px);height:clamp(120px,22vw,170px);background:linear-gradient(to bottom,#0e1828,#0a1018);border:6px solid #2a2015;box-shadow:inset 0 0 20px rgba(0,0,0,.4),0 3px 15px rgba(0,0,0,.4)}
        .blinds{position:absolute;inset:0}
        .blind-slat{width:100%;height:8px;background:linear-gradient(to bottom,rgba(255,240,200,.04),rgba(255,240,200,.08));border-bottom:2px solid rgba(40,30,20,.5)}
        .light-rays{position:absolute;top:6%;right:5%;width:300px;height:400px;background:repeating-linear-gradient(-25deg,transparent 0px,transparent 10px,rgba(255,240,200,.02) 10px,rgba(255,240,200,.02) 12px);transform:skewX(-12deg);pointer-events:none;opacity:.8}
        .dust-mote{position:absolute;width:2px;height:2px;background:rgba(255,240,200,.2);border-radius:50%;animation:dr 5s ease-in-out infinite;pointer-events:none}
        .typewriter-cut{position:absolute;bottom:34%;left:42%;width:clamp(65px,13vw,95px);height:clamp(48px,10vw,70px);cursor:pointer;z-index:15;animation:gi 10s ease-in-out infinite}
        .typewriter-cut img{width:100%;height:100%;object-fit:contain;filter:brightness(.7) contrast(1.3) grayscale(50%) sepia(20%);transition:filter .3s}
        .typewriter-cut:hover img{filter:brightness(.85) contrast(1.3) grayscale(30%) sepia(20%)}
        .off-desk{position:absolute;bottom:18%;left:18%;width:64%;height:16%;background:linear-gradient(to bottom,#4a3220,#3a2215,#2a1508);border-top:5px solid #5a3a22;background-image:repeating-linear-gradient(90deg,transparent,transparent 10px,rgba(80,50,20,.06) 10px,rgba(80,50,20,.06) 11px);box-shadow:0 4px 15px rgba(0,0,0,.4)}
        .desk-items{position:absolute;bottom:34%;left:20%;width:60%;height:4px;pointer-events:none}
        .off-chair{position:absolute;bottom:14%;left:34%;width:55px;height:100px}
        .ch-back{width:48px;height:60px;background:linear-gradient(to bottom,#3a2815,#2a1a0e);border-radius:5px 5px 0 0;margin:0 auto;border:2px solid #4a3520;background-image:repeating-linear-gradient(0deg,transparent,transparent 6px,rgba(80,60,30,.1) 6px,rgba(80,60,30,.1) 7px)}
        .ch-seat{width:52px;height:14px;background:linear-gradient(to bottom,#3a2815,#2a1a0e);margin:0 auto;border-radius:2px;border:1px solid #4a3520}
        .ch-legs{display:flex;justify-content:space-between;width:46px;margin:0 auto}
        .ch-leg{width:3px;height:20px;background:#2a1a0e}
        .desk-lamp{position:absolute;bottom:33%;left:24%;width:50px;height:70px;z-index:3}
        .ls{width:38px;height:26px;background:linear-gradient(to bottom,#2a5038,#1a3528);border-radius:0 0 20px 20px;margin:0 auto;box-shadow:0 0 10px rgba(255,240,200,.08)}
        .ls::after{content:'';position:absolute;bottom:2px;left:50%;transform:translateX(-50%);width:14px;height:5px;background:rgba(255,240,200,.7);border-radius:50%;box-shadow:0 0 6px rgba(255,240,200,.4)}
        .la{width:4px;height:38px;background:linear-gradient(to right,#8a7040,#c4a860,#8a7040);margin:0 auto}
        .la-base{width:22px;height:6px;background:#8a7040;border-radius:2px;margin:0 auto}
        .lcone{position:absolute;bottom:-25px;left:50%;transform:translateX(-50%);width:120px;height:90px;background:radial-gradient(ellipse at top,rgba(255,240,200,.14),rgba(255,240,200,.04) 40%,transparent 70%);pointer-events:none}
        .off-filing{position:absolute;bottom:12%;left:5%;width:48px;height:115px;background:linear-gradient(to bottom,#444,#3a3a3a,#333);cursor:pointer;z-index:15;box-shadow:2px 2px 8px rgba(0,0,0,.4)}
        .fdr{width:100%;height:32%;border-bottom:2px solid #2a2a2a;position:relative}
        .fdr::after{content:'';display:block;width:14px;height:4px;background:#666;margin:45% auto 0;border-radius:1px;box-shadow:0 0 2px rgba(0,0,0,.3)}
        .off-floor{position:absolute;bottom:0;left:0;width:100%;height:16%;background:linear-gradient(to bottom,#1a1510,#12100c);background-image:repeating-linear-gradient(90deg,transparent,transparent 20px,rgba(40,30,20,.08) 20px,rgba(40,30,20,.08) 21px)}
        .off-rug{position:absolute;bottom:2%;left:20%;width:60%;height:10%;background:rgba(80,30,20,.12);border:1px solid rgba(100,40,25,.15);border-radius:2px}
        /* Bookshelf */
        .off-books{position:absolute;top:10%;left:4%;width:40px;height:55%;background:#1a1510;border:3px solid #2a2015;box-shadow:inset 0 0 10px rgba(0,0,0,.3)}
        .book{position:absolute;left:3px;width:calc(100% - 6px);border-radius:1px}
        /* Hat rack */
        .hat-rack{position:absolute;top:15%;right:5%;width:3px;height:40%;background:#2a2015}
        .hat{position:absolute;top:0;left:-12px;width:27px;height:12px;background:#1a1512;border-radius:2px;border-bottom:2px solid #0e0c08}
        .hat-crown{position:absolute;top:-10px;left:5px;width:17px;height:12px;background:#1a1512;border-radius:3px 3px 0 0}

        /* === HOTEL LOBBY === */
        #sc-hotel{background:#0a0806}
        .hotel-wall{position:absolute;top:0;left:0;width:100%;height:72%;background:linear-gradient(to bottom,#241c12,#1c1610);background-image:repeating-linear-gradient(0deg,transparent,transparent 30px,rgba(80,60,30,.04) 30px,rgba(80,60,30,.04) 31px)}
        .hotel-wains{position:absolute;top:52%;left:0;width:100%;height:20%;background:#1a1510;background-image:repeating-linear-gradient(90deg,transparent,transparent 25px,rgba(60,50,30,.1) 25px,rgba(60,50,30,.1) 27px);border-top:3px solid #3a3020}
        .hotel-desk{position:absolute;bottom:18%;left:22%;width:56%;height:16%;background:linear-gradient(to bottom,#4a3520,#3a2515,#2a1508);border-top:5px solid #5a3a22;box-shadow:0 4px 15px rgba(0,0,0,.4);z-index:5;background-image:repeating-linear-gradient(90deg,transparent,transparent 8px,rgba(80,50,20,.06) 8px,rgba(80,50,20,.06) 9px)}
        .desk-bell{position:absolute;bottom:33%;left:40%;width:14px;height:12px;cursor:pointer;z-index:6}
        .hotel-keys{position:absolute;top:14%;left:18%;width:64%;height:36%;background:#16120e;border:4px solid #2a2015;box-shadow:inset 0 0 15px rgba(0,0,0,.4),0 3px 10px rgba(0,0,0,.3)}
        .key-hook{position:absolute;cursor:pointer;font-family:'Special Elite',monospace;font-size:5px;color:#8a7a50;text-align:center}
        .key-hook::before{content:'';display:block;width:8px;height:4px;background:#8a7a50;border-radius:1px;margin:0 auto 2px}
        .key-hook::after{content:'';display:block;width:5px;height:8px;background:#a09060;margin:0 auto;border-radius:0 0 1px 1px}
        .key-hook.empty::after{display:none}
        .key-hook.empty{opacity:.3}
        .hotel-carpet{position:absolute;bottom:0;left:0;width:100%;height:18%;background:#1a0e08;background-image:repeating-linear-gradient(90deg,rgba(100,20,10,.06),rgba(100,20,10,.06) 15px,rgba(80,15,8,.04) 15px,rgba(80,15,8,.04) 30px),repeating-linear-gradient(0deg,transparent,transparent 15px,rgba(100,20,10,.03) 15px,rgba(100,20,10,.03) 30px)}
        .hotel-column{position:absolute;bottom:18%;width:24px;background:linear-gradient(to right,#1a1510,#302a20,#1a1510);box-shadow:2px 0 8px rgba(0,0,0,.3)}
        .hotel-col-cap{position:absolute;top:0;left:-3px;width:30px;height:8px;background:#302a20;border-radius:2px}
        .hotel-painting{position:absolute;overflow:hidden;border:4px solid #3a3020;box-shadow:2px 2px 10px rgba(0,0,0,.5)}
        .hotel-sign{position:absolute;top:4%;left:50%;transform:translateX(-50%);font-family:'Playfair Display',serif;font-size:clamp(14px,3.5vw,24px);color:#a09060;letter-spacing:6px;text-shadow:0 0 10px rgba(160,140,90,.3)}
        /* Chandelier */
        .chandelier{position:absolute;top:0;left:50%;transform:translateX(-50%);width:100px;height:60px;z-index:3}
        .ch-chain{position:absolute;left:50%;width:2px;height:15px;background:#8a7a50;transform:translateX(-50%)}
        .ch-hub{position:absolute;top:15px;left:50%;transform:translateX(-50%);width:20px;height:8px;background:#8a7a50;border-radius:2px}
        .ch-arm-el{position:absolute;top:20px;height:2px;background:#8a7a50}
        .ch-bulb-el{position:absolute;top:18px;width:6px;height:8px;background:rgba(255,240,200,.7);border-radius:50%;box-shadow:0 0 10px rgba(255,240,200,.3),0 0 25px rgba(255,240,200,.1)}
        .ch-glow{position:absolute;top:20px;left:50%;transform:translateX(-50%);width:200px;height:250px;background:radial-gradient(ellipse at top,rgba(255,230,180,.06),transparent 50%);pointer-events:none}
        /* Potted plant */
        .lobby-plant{position:absolute;bottom:18%;width:20px;height:50px}
        .plant-pot{position:absolute;bottom:0;left:2px;width:16px;height:18px;background:linear-gradient(#6a3a20,#5a2a15);clip-path:polygon(0% 0%,100% 0%,85% 100%,15% 100%)}
        .plant-leaf{position:absolute;width:3px;height:16px;background:#2a4a2a;border-radius:50%;transform-origin:bottom center}

        /* === HOTEL ROOM 214 (CRIME SCENE) === */
        #sc-room{background:#0c0a08}
        /* Wallpaper - faded floral hotel pattern */
        .room-wall{position:absolute;top:0;left:0;width:100%;height:72%;background:#1a1510;background-image:repeating-linear-gradient(0deg,transparent,transparent 28px,rgba(80,50,30,.05) 28px,rgba(80,50,30,.05) 29px),repeating-linear-gradient(90deg,transparent,transparent 28px,rgba(80,50,30,.04) 28px,rgba(80,50,30,.04) 29px),radial-gradient(circle at 14px 14px,rgba(100,60,40,.03) 8px,transparent 8px);background-size:100% 100%,100% 100%,28px 28px}
        .room-molding{position:absolute;top:0;left:0;width:100%;height:4px;background:linear-gradient(to bottom,#3a3020,#2a2015);box-shadow:0 2px 4px rgba(0,0,0,.3)}
        .room-baseboard{position:absolute;top:70%;left:0;width:100%;height:3px;background:#2a2015}
        /* Blood spatter stain on wall - subtle */
        .room-stain{position:absolute;top:28%;left:38%;width:40px;height:30px;background:radial-gradient(ellipse,rgba(80,15,10,.12),transparent 60%);pointer-events:none}
        /* Bed - detailed with rumpled sheets, headboard, frame */
        .room-bed{position:absolute;bottom:16%;left:12%;width:52%;height:30%;z-index:3}
        .bed-headboard{position:absolute;top:0;left:0;width:100%;height:25%;background:linear-gradient(to bottom,#4a3218,#3a2510);border-radius:4px 4px 0 0;border:2px solid #5a3a20;background-image:repeating-linear-gradient(90deg,transparent,transparent 12px,rgba(80,50,20,.08) 12px,rgba(80,50,20,.08) 13px)}
        .bed-mattress{position:absolute;top:22%;left:0;width:100%;height:78%;background:linear-gradient(to bottom,#d8d0c0,#c8c0b0,#b8b0a0);border:2px solid #8a7a5a;border-radius:0 0 3px 3px;box-shadow:0 4px 12px rgba(0,0,0,.4)}
        .bed-sheet{position:absolute;top:25%;left:0;width:100%;height:75%;background:linear-gradient(135deg,#d8d0c0 0%,#c8c0b0 20%,#d0c8b8 40%,#c0b8a8 55%,#d5cdc0 70%,#c8c0b0 100%);border-radius:0 0 3px 3px;overflow:hidden}
        .sheet-fold{position:absolute;background:rgba(0,0,0,.04);transform-origin:center}
        .sheet-rumple{position:absolute;background:linear-gradient(to bottom,rgba(255,250,240,.04),transparent);border-radius:50%}
        .bed-pillow{position:absolute;top:26%;width:22%;height:20%;background:linear-gradient(135deg,#f0e8d8,#e0d8c8);border-radius:4px;border:1px solid #c0b8a0;box-shadow:1px 2px 4px rgba(0,0,0,.15)}
        .pillow-crease{position:absolute;top:40%;left:15%;width:70%;height:1px;background:rgba(0,0,0,.08)}
        .bed-pillow-indent{position:absolute;top:30%;left:5%;width:20%;height:18%;background:linear-gradient(135deg,#e8e0d0,#dcd4c4);border-radius:4px;border:1px solid #c0b8a0;box-shadow:inset 2px 2px 5px rgba(0,0,0,.08)}
        .bed-leg{position:absolute;bottom:-6px;width:6px;height:8px;background:#3a2510;border-radius:0 0 1px 1px}
        /* Window with detailed curtains */
        .room-window{position:absolute;top:8%;right:8%;width:clamp(110px,20vw,155px);height:clamp(110px,20vw,155px);background:linear-gradient(to bottom,#0a1520,#050a10);border:5px solid #2a2015;box-shadow:inset 0 0 20px rgba(0,0,0,.4),0 3px 15px rgba(0,0,0,.4)}
        .room-window-pane{position:absolute;top:0;left:0;width:100%;height:100%;background:linear-gradient(to bottom,#0e1828,#080e18)}
        .window-cross-h{position:absolute;top:50%;left:0;width:100%;height:3px;background:#2a2015;transform:translateY(-50%)}
        .window-cross-v{position:absolute;top:0;left:50%;width:3px;height:100%;background:#2a2015;transform:translateX(-50%)}
        .room-moonlight{position:absolute;top:8%;right:0;width:250px;height:350px;background:repeating-linear-gradient(-20deg,transparent 0px,transparent 12px,rgba(150,180,220,.015) 12px,rgba(150,180,220,.015) 14px);transform:skewX(-8deg);pointer-events:none;opacity:.7}
        .moon-dust{position:absolute;width:2px;height:2px;background:rgba(150,180,220,.15);border-radius:50%;animation:dr 6s ease-in-out infinite;pointer-events:none}
        .room-curtain{position:absolute;top:-5%;height:112%;z-index:2}
        .curtain-fold{position:absolute;top:0;height:100%;background:linear-gradient(to right,#3a1515,#2a0a0a);border-radius:0 0 2px 2px}
        .curtain-tie{position:absolute;top:35%;width:6px;height:3px;background:#5a3a30;border-radius:1px}
        .curtain-tassel{position:absolute;top:38%;width:4px;height:8px;background:linear-gradient(to bottom,#5a3a30,#4a2a20);border-radius:0 0 2px 2px}
        /* Nightstand - detailed */
        .room-table{position:absolute;bottom:22%;right:10%;width:clamp(52px,10vw,72px);height:clamp(38px,7.5vw,55px);background:linear-gradient(to bottom,#3d2a18,#2a1a0e);border-top:4px solid #4a3520;box-shadow:2px 3px 10px rgba(0,0,0,.4);z-index:4;background-image:repeating-linear-gradient(90deg,transparent,transparent 6px,rgba(80,50,20,.06) 6px,rgba(80,50,20,.06) 7px)}
        .table-drawer{position:absolute;bottom:4px;left:8%;width:84%;height:40%;background:linear-gradient(to bottom,#342214,#2a1a0e);border:1px solid #4a3520}
        .table-knob{position:absolute;top:40%;left:50%;transform:translateX(-50%);width:6px;height:3px;background:#6a5a40;border-radius:1px;box-shadow:0 0 2px rgba(0,0,0,.3)}
        .table-leg{position:absolute;bottom:-8px;width:4px;height:10px;background:#2a1a0e}
        /* Bedside lamp */
        .room-lamp{position:absolute;bottom:34%;right:14%;width:28px;height:45px;z-index:5}
        .rl-shade{width:26px;height:16px;background:linear-gradient(to bottom,#d8c8a0,#c8b890);border-radius:0 0 50% 50%;margin:0 auto;position:relative;box-shadow:0 0 15px rgba(255,220,150,.06)}
        .rl-shade::after{content:'';position:absolute;bottom:0;left:50%;transform:translateX(-50%);width:12px;height:4px;background:rgba(255,230,170,.5);border-radius:50%;box-shadow:0 0 8px rgba(255,220,150,.25)}
        .rl-neck{width:3px;height:22px;background:linear-gradient(to right,#8a7a50,#a09060,#8a7a50);margin:0 auto}
        .rl-base{width:16px;height:4px;background:#8a7a50;border-radius:2px;margin:0 auto}
        .rl-pool{position:absolute;top:16px;left:50%;transform:translateX(-50%);width:60px;height:100px;background:radial-gradient(ellipse at top,rgba(255,220,150,.05),transparent 60%);pointer-events:none}
        /* Dresser with mirror */
        .room-dresser{position:absolute;bottom:16%;left:2%;width:clamp(40px,8vw,55px);height:clamp(55px,11vw,75px);z-index:3}
        .dresser-body{width:100%;height:70%;background:linear-gradient(to bottom,#3a2815,#2a1a0e);border:2px solid #4a3520;box-shadow:2px 2px 8px rgba(0,0,0,.4);position:absolute;bottom:0;background-image:repeating-linear-gradient(90deg,transparent,transparent 8px,rgba(80,50,20,.06) 8px,rgba(80,50,20,.06) 9px)}
        .dresser-drawer{position:absolute;left:6%;width:88%;height:28%;background:linear-gradient(to bottom,#342214,#2a1a0e);border:1px solid #4a3520}
        .dresser-knob{position:absolute;top:35%;left:50%;transform:translateX(-50%);width:5px;height:3px;background:#6a5a40;border-radius:1px}
        .dresser-mirror{position:absolute;top:0;left:10%;width:80%;height:35%;background:linear-gradient(170deg,rgba(20,18,15,.85),rgba(30,28,25,.7),rgba(15,12,10,.9));border:3px solid #3a2815;box-shadow:inset 0 0 10px rgba(0,0,0,.4)}
        .dresser-leg{position:absolute;bottom:-5px;width:4px;height:7px;background:#2a1a0e}
        /* Floor - dark hotel carpet */
        .room-floor{position:absolute;bottom:0;left:0;width:100%;height:16%;background:#14100c;background-image:repeating-linear-gradient(90deg,rgba(80,20,15,.04),rgba(80,20,15,.04) 12px,rgba(60,15,10,.03) 12px,rgba(60,15,10,.03) 24px),repeating-linear-gradient(0deg,transparent,transparent 12px,rgba(80,20,15,.02) 12px,rgba(80,20,15,.02) 24px)}
        .room-rug{position:absolute;bottom:1%;left:25%;width:50%;height:12%;background:rgba(60,20,15,.15);border:1px solid rgba(80,30,20,.1);border-radius:1px}
        /* Chalk outline - body shaped */
        .chalk-outline{position:absolute;bottom:17%;left:28%;width:clamp(90px,18vw,130px);height:clamp(45px,9vw,65px);z-index:6;pointer-events:none}
        /* Evidence markers - tent style */
        .evidence-marker{position:absolute;width:18px;height:22px;cursor:pointer;z-index:15;animation:dr 4s ease-in-out infinite}
        .ev-tent{width:100%;height:100%;background:linear-gradient(135deg,#ddd830 50%,#c8c020 50%);clip-path:polygon(0% 100%,50% 0%,100% 100%);position:relative}
        .ev-num{position:absolute;bottom:2px;left:50%;transform:translateX(-50%);font-size:7px;font-weight:bold;color:#1a1a1a;font-family:sans-serif}
        /* Crime scene tape - more visible */
        .room-tape{position:absolute;top:0;left:0;width:100%;height:100%;pointer-events:none;z-index:8}
        .tape-strip{position:absolute;height:18px;background:repeating-linear-gradient(90deg,#ddcc00 0px,#ddcc00 18px,#111 18px,#111 36px);opacity:.2;transform-origin:center;box-shadow:0 1px 4px rgba(0,0,0,.3)}
        .tape-text{position:absolute;width:100%;text-align:center;font-family:sans-serif;font-size:5px;font-weight:bold;color:#111;letter-spacing:3px;line-height:18px}
        /* Police flashlight sweep */
        .room-flash{position:absolute;top:0;left:0;width:100%;height:100%;pointer-events:none;z-index:1;background:radial-gradient(ellipse at 65% 45%,rgba(180,200,220,.03),transparent 30%)}
        /* Dark atmosphere overlay */
        .room-dark{position:absolute;top:0;left:0;width:100%;height:100%;pointer-events:none;background:linear-gradient(to bottom,rgba(12,10,8,.3),transparent 20%,transparent 80%,rgba(12,10,8,.2));z-index:7}

        /* === HOTSPOT === */
        .hotspot{position:absolute;cursor:pointer;transition:filter .2s;z-index:15}
        .hotspot:hover{filter:brightness(1.3) drop-shadow(0 0 8px rgba(255,200,100,.3))}

        /* === EXIT BUTTON === */
        .exit-btn{position:absolute;bottom:20px;left:20px;padding:10px 22px;background:rgba(25,20,15,.9);border:2px solid #4a3a2a;color:#c4a35a;font-family:'Special Elite',monospace;font-size:13px;cursor:pointer;z-index:300;letter-spacing:2px}
        .exit-btn:hover{background:rgba(50,40,30,.9)}

        /* === UI === */
        #ui{position:fixed;top:0;left:0;width:100%;height:100%;pointer-events:none;z-index:500}
        #ui>*{pointer-events:auto}
        #dlg{position:absolute;bottom:50px;left:50%;transform:translateX(-50%);width:90%;max-width:540px;background:rgba(8,6,4,.96);border:2px solid #2d2418;border-left:5px solid #c4a35a;padding:18px 20px;display:none;box-shadow:0 10px 50px rgba(0,0,0,.9)}
        #dlg.vis{display:block}
        .ds{font-family:'Playfair Display',serif;font-size:11px;color:#c4a35a;letter-spacing:4px;margin-bottom:8px;text-transform:uppercase}
        .dt{font-family:'Special Elite',monospace;font-size:15px;color:#d4c5a9;line-height:1.7}
        .dc{font-size:9px;color:#4a3a2a;margin-top:10px;text-align:right;animation:pu 2s ease-in-out infinite}
        #ltitle{position:absolute;top:20px;left:50%;transform:translateX(-50%);font-family:'Playfair Display',serif;font-size:clamp(18px,5vw,28px);font-weight:900;color:#b0a080;letter-spacing:8px;text-transform:uppercase;text-shadow:0 2px 20px rgba(0,0,0,.9);opacity:0;transition:opacity 1s;pointer-events:none}
        #ltitle.show{opacity:1}
        #inv{position:absolute;top:16px;left:16px;display:flex;gap:5px}
        .inv-slot{width:38px;height:38px;background:rgba(15,12,8,.88);border:2px solid #3a2a1a;display:flex;align-items:center;justify-content:center;font-size:16px;cursor:pointer}
        .inv-slot:hover{border-color:#8a7a5a;background:rgba(30,24,16,.9)}
        #case-btn{position:absolute;top:16px;right:16px;padding:6px 14px;background:rgba(15,12,8,.88);border:2px solid #3a2a1a;color:#8a7a5a;font-family:'Special Elite',monospace;font-size:10px;letter-spacing:2px;cursor:pointer}
        #case-btn:hover{border-color:#8a7a5a;color:#c4a35a}
        #case-panel{position:fixed;top:50%;left:50%;transform:translate(-50%,-50%);width:85%;max-width:500px;max-height:70vh;overflow-y:auto;background:#f5f0e6;border:3px solid #3d3428;padding:28px;z-index:600;box-shadow:0 20px 60px rgba(0,0,0,.8);display:none}
        #case-panel.vis{display:block}
        #case-panel h2{font-family:'Playfair Display',serif;color:#2a2015;margin-bottom:16px;border-bottom:2px solid #3d3428;padding-bottom:8px;font-size:16px;letter-spacing:3px}
        .cnote{font-family:'Special Elite',monospace;color:#3a3025;font-size:13px;margin-bottom:10px;padding-left:14px;border-left:3px solid #8a7a5a;line-height:1.5}
        #case-panel .close-x{position:absolute;top:10px;right:14px;font-size:20px;cursor:pointer;color:#3a3025}
        #hint{position:absolute;bottom:10px;left:50%;transform:translateX(-50%);font-size:10px;color:#3a2a1a;letter-spacing:2px;white-space:nowrap;transition:opacity 2s}
        #grain{position:fixed;top:0;left:0;width:100%;height:100%;pointer-events:none;opacity:.05;z-index:1000;background-image:url("data:image/svg+xml,%3Csvg viewBox='0 0 256 256' xmlns='http://www.w3.org/2000/svg'%3E%3Cfilter id='n'%3E%3CfeTurbulence type='fractalNoise' baseFrequency='.85' numOctaves='4' stitchTiles='stitch'/%3E%3C/filter%3E%3Crect width='100%25' height='100%25' filter='url(%23n)'/%3E%3C/svg%3E")}
        #vig{position:fixed;top:0;left:0;width:100%;height:100%;pointer-events:none;background:radial-gradient(ellipse at center,transparent 30%,rgba(0,0,0,.75) 100%);z-index:999}

        /* === TITLE === */
        #title{position:fixed;top:0;left:0;width:100%;height:100%;background:#060506;z-index:2000;display:flex;flex-direction:column;align-items:center;justify-content:center;cursor:pointer;transition:opacity 1.8s;overflow:hidden}
        #title.gone{opacity:0;pointer-events:none}
        .tcol{position:absolute;top:0;left:0;width:100%;height:100%;opacity:.15}
        .tcol img{width:100%;height:100%;object-fit:cover;filter:grayscale(100%) contrast(1.8) brightness(.4)}
        #title h1{font-family:'Playfair Display',serif;font-weight:900;font-size:clamp(48px,16vw,140px);color:transparent;-webkit-text-stroke:2px #8a7050;letter-spacing:12px;z-index:1}
        #title .sub{font-family:'Special Elite',monospace;font-size:clamp(10px,3vw,16px);color:#2a1a0a;letter-spacing:10px;margin-top:15px;z-index:1}
        #title .tag{font-family:'Special Elite',monospace;font-size:clamp(8px,2vw,12px);color:#1a1008;letter-spacing:3px;margin-top:30px;max-width:80%;text-align:center;line-height:1.8;z-index:1}
        #title .tap{font-size:11px;color:#1a0a00;letter-spacing:4px;margin-top:50px;animation:pu 2.5s ease-in-out infinite;z-index:1}
        #title .yr{position:absolute;bottom:25px;font-family:'Playfair Display',serif;font-size:14px;color:#140a00;letter-spacing:5px;z-index:1}
    </style>
</head>
<body>
<div id="game">

<!-- ============ STREET ============ -->
<div id="sc-street" class="scene active">
    <div class="photo-bg"><img src="https://upload.wikimedia.org/wikipedia/commons/thumb/a/a4/Gottlieb_52nd_Street.jpg/1280px-Gottlieb_52nd_Street.jpg" alt="52nd Street NYC, Gottlieb 1948" crossorigin="anonymous" onerror="this.parentElement.style.background='linear-gradient(to bottom,#080810,#121220,#0a0a14)'"></div>
    <div class="bg-fade"></div><div class="bg-side"></div>
    <div class="moon"></div>
    <div class="bldg-layer">
        <div class="bs b1"></div><div class="bs b2"></div><div class="bs b3"></div><div class="bs b4"></div><div class="bs b5"></div>
        <div class="w" style="bottom:65%;left:4%;width:5px;height:7px"></div>
        <div class="w" style="bottom:58%;left:7%;width:4px;height:6px;animation-delay:-1s"></div>
        <div class="w" style="bottom:70%;left:11%;width:5px;height:7px;animation-delay:-2s"></div>
        <div class="w" style="bottom:55%;left:14%;width:4px;height:5px;animation-delay:-3s"></div>
        <div class="w" style="bottom:68%;left:22%;width:5px;height:8px;animation-delay:-.5s"></div>
        <div class="w" style="bottom:60%;left:25%;width:4px;height:6px;animation-delay:-1.5s"></div>
        <div class="w" style="bottom:72%;left:30%;width:5px;height:7px;animation-delay:-2.5s"></div>
        <div class="w" style="bottom:63%;left:34%;width:4px;height:6px;animation-delay:-3.5s"></div>
        <div class="w" style="bottom:75%;left:42%;width:5px;height:8px;animation-delay:-.8s"></div>
        <div class="w" style="bottom:66%;left:46%;width:4px;height:6px;animation-delay:-1.8s"></div>
        <div class="w" style="bottom:70%;left:50%;width:5px;height:7px;animation-delay:-2.8s"></div>
        <div class="w" style="bottom:58%;left:54%;width:4px;height:5px;animation-delay:-.3s"></div>
        <div class="w" style="bottom:62%;left:66%;width:5px;height:7px;animation-delay:-1.3s"></div>
        <div class="w" style="bottom:55%;left:70%;width:4px;height:6px;animation-delay:-2.3s"></div>
        <div class="w" style="bottom:68%;left:84%;width:5px;height:7px;animation-delay:-3.3s"></div>
        <div class="w" style="bottom:60%;left:88%;width:4px;height:6px;animation-delay:-.7s"></div>
        <div class="w" style="bottom:73%;left:92%;width:5px;height:7px;animation-delay:-1.7s"></div>
    </div>
    <div class="neon nr" style="top:26%;left:8%" data-door="bar">BAR</div>
    <div class="neon nbl" style="top:16%;left:54%" data-door="hotel">AVALON<br><span style="font-size:60%;letter-spacing:3px">HOTEL</span></div>
    <div class="neon na" style="top:28%;right:7%">EATS</div>
    <div class="neon ng" style="top:24%;left:40%">DRUGS</div>
    <div class="neon sp" style="top:20%;left:31%" data-door="office">NOIR INVESTIGATIONS<br><span style="font-size:85%;opacity:.6">3rd Floor</span></div>
    <div class="nr-ref" style="left:9%;width:60px;height:18%;background:linear-gradient(to bottom,rgba(255,30,30,.12),transparent);animation-delay:-.5s"></div>
    <div class="nr-ref" style="left:55%;width:50px;height:18%;background:linear-gradient(to bottom,rgba(60,130,255,.1),transparent);animation-delay:-1.5s"></div>
    <div class="nr-ref" style="right:8%;width:45px;height:18%;background:linear-gradient(to bottom,rgba(255,170,50,.08),transparent);animation-delay:-2.5s"></div>
    <div class="st-ground"><div class="sidewalk"></div></div>
    <div class="lamp" style="left:22%"><div class="lh"></div><div class="lp"></div><div class="lpool"></div></div>
    <div class="lamp" style="left:65%"><div class="lh"></div><div class="lp"></div><div class="lpool"></div></div>
    <div class="car-cut" id="obj-car"><img src="https://upload.wikimedia.org/wikipedia/commons/thumb/3/3f/1957_Chevrolet_Bel_Air_Sport_Sedan_%2826233032368%29.jpg/640px-1957_Chevrolet_Bel_Air_Sport_Sedan_%2826233032368%29.jpg" alt="1957 Chevrolet" crossorigin="anonymous" onerror="this.style.display='none';this.parentElement.style.background='#080808';this.parentElement.style.clipPath='polygon(0% 100%,0% 55%,5% 40%,20% 25%,40% 8%,65% 5%,85% 20%,100% 45%,100% 100%)'"><span class="ipip">?</span></div>
    <div class="clue cl-paper" id="clue-newspaper" data-item="newspaper"><div class="pt">DAILY HERALD</div><div class="ph">WOMAN FOUND DEAD AT AVALON HOTEL</div><div class="pp">Police have ruled the death a suicide but sources close to the investigation suggest foul play cannot be ruled out...</div><span class="ipip" style="top:-16px">!</span></div>
    <div class="clue cl-match" id="clue-matchbook" data-item="matchbook"><div class="mt">THE<br>BLUE<br>MOON</div><span class="ipip" style="top:-16px">!</span></div>
    <div class="door-zone" data-door="bar" data-label="ENTER BAR" style="bottom:20%;left:6%;width:9%;height:18%;background:rgba(255,30,30,.03)"></div>
    <div class="door-zone" data-door="office" data-label="ENTER OFFICE" style="bottom:20%;left:30%;width:8%;height:16%;background:rgba(180,160,120,.03)"></div>
    <div class="door-zone" data-door="hotel" data-label="ENTER HOTEL" style="bottom:20%;left:55%;width:8%;height:16%;background:rgba(60,130,255,.03)"></div>
    <div class="ch viv idle" id="npc-vivian" style="left:36%;bottom:20%" data-npc="vivian">
        <div class="pb"><img src="https://upload.wikimedia.org/wikipedia/commons/2/29/Lizabeth_Scott-publicity.JPG" alt="Femme Fatale" crossorigin="anonymous" onerror="this.style.display='none';this.parentElement.style.background='linear-gradient(to bottom,#1a1018,#0e0810)';this.parentElement.style.clipPath='polygon(35% 0%,65% 0%,70% 15%,72% 40%,78% 100%,22% 100%,28% 40%,30% 15%)'"></div>
        <div class="csmoke"></div><div class="csmoke"></div><div class="csmoke"></div>
        <div class="cshadow"></div><span class="ipip">?</span>
    </div>
    <div class="ch idle" id="player" style="left:16%;bottom:20%">
        <div class="pb"><img src="https://upload.wikimedia.org/wikipedia/commons/4/43/Humphrey_Bogart_1945.JPG" alt="Detective" crossorigin="anonymous" onerror="this.style.display='none';this.parentElement.style.background='linear-gradient(to bottom,#0e0c0a,#080606)';this.parentElement.style.clipPath='polygon(30% 0%,70% 0%,78% 10%,85% 30%,100% 35%,95% 90%,70% 100%,30% 100%,5% 90%,0% 35%,15% 30%,22% 10%)'"></div>
        <div class="cshadow"></div>
    </div>
</div>

<!-- ============ BAR ============ -->
<div id="sc-bar" class="scene">
    <div class="bar-bg">
        <div class="bar-wallpaper"></div>
        <div class="bar-wains"></div>
    </div>
    <div class="bar-mirror"></div>
    <div class="mirror-shine"></div>

    <!-- SVG Bottles on shelves -->
    <svg style="position:absolute;top:5%;left:16%;width:68%;height:36%;z-index:2" viewBox="0 0 400 200" preserveAspectRatio="xMidYMid meet">
        <!-- Top shelf -->
        <rect x="0" y="95" width="400" height="5" fill="#3a2518" rx="1"/>
        <!-- Bottom shelf -->
        <rect x="0" y="190" width="400" height="5" fill="#3a2518" rx="1"/>
        <!-- Top row bottles -->
        <g opacity=".85">
            <!-- Whiskey tall -->
            <rect x="20" y="30" width="16" height="64" rx="2" fill="#3a2510"/><rect x="22" y="32" width="12" height="30" rx="1" fill="#5a3a15" opacity=".5"/><rect x="24" y="20" width="8" height="12" rx="2" fill="#3a2510"/><text x="28" y="55" fill="#8a7040" font-size="4" text-anchor="middle">RYE</text>
            <!-- Green bottle -->
            <rect x="55" y="38" width="14" height="56" rx="2" fill="#1a3518"/><rect x="57" y="40" width="10" height="28" rx="1" fill="#2a5a28" opacity=".4"/><rect x="59" y="28" width="6" height="12" rx="2" fill="#1a3518"/>
            <!-- Short round -->
            <rect x="90" y="48" width="18" height="46" rx="3" fill="#4a2a18"/><rect x="92" y="50" width="14" height="22" rx="2" fill="#6a4020" opacity=".4"/><rect x="96" y="40" width="6" height="10" rx="2" fill="#4a2a18"/>
            <!-- Gin tall -->
            <rect x="130" y="25" width="12" height="69" rx="1" fill="rgba(180,200,210,.2)"/><rect x="132" y="27" width="8" height="40" rx="1" fill="rgba(200,220,230,.15)"/><rect x="133" y="18" width="6" height="9" rx="1" fill="rgba(180,200,210,.25)"/>
            <!-- Bourbon -->
            <rect x="165" y="35" width="16" height="59" rx="2" fill="#4a2010"/><rect x="167" y="37" width="12" height="30" rx="1" fill="#6a3518" opacity=".4"/><rect x="170" y="26" width="6" height="11" rx="2" fill="#4a2010"/><rect x="167" y="50" width="12" height="8" fill="#d8c8a0" opacity=".3"/>
            <!-- Vermouth -->
            <rect x="200" y="40" width="14" height="54" rx="2" fill="#2a1520"/><rect x="202" y="42" width="10" height="26" rx="1" fill="#4a2535" opacity=".4"/><rect x="204" y="32" width="6" height="10" rx="2" fill="#2a1520"/>
            <!-- Scotch -->
            <rect x="240" y="32" width="15" height="62" rx="2" fill="#5a3a10"/><rect x="242" y="34" width="11" height="32" rx="1" fill="#7a5020" opacity=".35"/><rect x="245" y="23" width="5" height="11" rx="2" fill="#5a3a10"/><text x="248" y="58" fill="#a08040" font-size="3.5" text-anchor="middle">12yr</text>
            <!-- Vodka clear -->
            <rect x="278" y="28" width="12" height="66" rx="1" fill="rgba(200,210,220,.18)"/><rect x="280" y="30" width="8" height="38" rx="1" fill="rgba(220,230,240,.12)"/><rect x="282" y="20" width="4" height="10" rx="1" fill="rgba(200,210,220,.2)"/>
            <!-- Brandy squat -->
            <rect x="310" y="50" width="20" height="44" rx="4" fill="#3a1a08"/><rect x="312" y="52" width="16" height="20" rx="3" fill="#5a2a10" opacity=".4"/><rect x="317" y="40" width="6" height="12" rx="2" fill="#3a1a08"/>
            <!-- Rum dark -->
            <rect x="350" y="35" width="14" height="59" rx="2" fill="#1a0e08"/><rect x="352" y="37" width="10" height="28" rx="1" fill="#2a1a10" opacity=".5"/><rect x="355" y="26" width="4" height="11" rx="1" fill="#1a0e08"/>
            <!-- Wine -->
            <rect x="385" y="30" width="12" height="64" rx="1" fill="#2a0a0a"/><rect x="387" y="32" width="8" height="35" rx="1" fill="#4a1515" opacity=".3"/><rect x="389" y="22" width="4" height="10" rx="1" fill="#2a0a0a"/>
        </g>
        <!-- Bottom row bottles -->
        <g opacity=".8">
            <rect x="15" y="125" width="15" height="63" rx="2" fill="#2a2015"/><rect x="17" y="127" width="11" height="30" rx="1" fill="#3a3020" opacity=".4"/><rect x="20" y="116" width="5" height="11" rx="1" fill="#2a2015"/>
            <rect x="50" y="130" width="18" height="58" rx="3" fill="#3a1a10"/><rect x="52" y="132" width="14" height="28" rx="2" fill="#5a2a15" opacity=".35"/><rect x="56" y="122" width="6" height="10" rx="2" fill="#3a1a10"/>
            <rect x="90" y="128" width="12" height="60" rx="1" fill="rgba(160,180,160,.2)"/><rect x="92" y="130" width="8" height="32" rx="1" fill="rgba(180,200,180,.12)"/><rect x="93" y="120" width="6" height="10" rx="1" fill="rgba(160,180,160,.22)"/>
            <rect x="125" y="132" width="16" height="56" rx="2" fill="#4a2818"/><rect x="127" y="134" width="12" height="26" rx="1" fill="#6a3a20" opacity=".35"/><rect x="130" y="124" width="6" height="10" rx="2" fill="#4a2818"/>
            <rect x="165" y="126" width="14" height="62" rx="2" fill="#1a1530"/><rect x="167" y="128" width="10" height="30" rx="1" fill="#2a2545" opacity=".4"/><rect x="169" y="118" width="6" height="10" rx="2" fill="#1a1530"/>
            <rect x="205" y="135" width="18" height="53" rx="3" fill="#3a2510"/><rect x="207" y="137" width="14" height="24" rx="2" fill="#5a3a18" opacity=".4"/><rect x="211" y="126" width="6" height="11" rx="2" fill="#3a2510"/>
            <rect x="245" y="128" width="13" height="60" rx="2" fill="#2a1a0e"/><rect x="247" y="130" width="9" height="30" rx="1" fill="#4a2a15" opacity=".4"/><rect x="249" y="120" width="5" height="10" rx="1" fill="#2a1a0e"/>
            <rect x="280" y="130" width="16" height="58" rx="2" fill="rgba(180,170,150,.2)"/><rect x="282" y="132" width="12" height="28" rx="1" fill="rgba(200,190,170,.12)"/><rect x="285" y="122" width="6" height="10" rx="2" fill="rgba(180,170,150,.22)"/>
            <rect x="320" y="126" width="14" height="62" rx="2" fill="#3a1510"/><rect x="322" y="128" width="10" height="32" rx="1" fill="#5a2518" opacity=".35"/><rect x="325" y="118" width="4" height="10" rx="1" fill="#3a1510"/>
            <rect x="355" y="132" width="15" height="56" rx="2" fill="#2a2a18"/><rect x="357" y="134" width="11" height="26" rx="1" fill="#3a3a22" opacity=".4"/><rect x="360" y="124" width="5" height="10" rx="1" fill="#2a2a18"/>
        </g>
    </svg>

    <!-- Pendant lights -->
    <div class="pendant" style="left:20%"><div class="pendant-cord"></div><div class="pendant-shade"></div><div class="pendant-pool"></div></div>
    <div class="pendant" style="left:50%"><div class="pendant-cord"></div><div class="pendant-shade"></div><div class="pendant-pool"></div></div>
    <div class="pendant" style="left:78%"><div class="pendant-cord"></div><div class="pendant-shade"></div><div class="pendant-pool"></div></div>

    <!-- Neon beer sign -->
    <div class="beer-sign">Schlitz</div>

    <!-- Framed photo on wall - uses Gottlieb -->
    <div style="position:absolute;top:6%;left:3%;width:clamp(40px,8vw,60px);height:clamp(30px,6vw,45px);border:4px solid #2a1a12;box-shadow:2px 3px 10px rgba(0,0,0,.5);overflow:hidden">
        <img src="https://upload.wikimedia.org/wikipedia/commons/thumb/a/a4/Gottlieb_52nd_Street.jpg/320px-Gottlieb_52nd_Street.jpg" alt="" style="width:100%;height:100%;object-fit:cover;filter:grayscale(80%) sepia(40%) brightness(.4)" crossorigin="anonymous">
    </div>

    <!-- Bar counter -->
    <div class="bar-counter"></div>
    <div class="counter-edge"></div>
    <div class="counter-shine"></div>

    <!-- Items on counter -->
    <div class="bar-ashtray" style="bottom:35%;left:22%"><div style="position:absolute;top:-3px;left:6px;width:2px;height:8px;background:#aaa;transform:rotate(-20deg);border-radius:1px"></div></div>
    <div class="bar-coaster" style="bottom:35%;left:50%"></div>
    <div class="bar-coaster" style="bottom:35%;left:75%"></div>
    <div class="bar-napkin" style="bottom:35%;left:35%"></div>
    <div class="bar-napkin" style="bottom:35.5%;left:60%;transform:rotate(-8deg)"></div>

    <!-- Stools -->
    <div class="stool" style="left:14%"><div class="stool-top"></div><div class="stool-leg"></div><div class="stool-base"></div></div>
    <div class="stool" style="left:30%;animation-delay:-2s"><div class="stool-top"></div><div class="stool-leg"></div><div class="stool-base"></div></div>
    <div class="stool" style="left:54%;animation-delay:-4s"><div class="stool-top"></div><div class="stool-leg"></div><div class="stool-base"></div></div>
    <div class="stool" style="left:72%;animation-delay:-6s"><div class="stool-top"></div><div class="stool-leg"></div><div class="stool-base"></div></div>

    <!-- Floor -->
    <div class="bar-floor"></div>
    <div class="floor-shine"></div>

    <!-- Smoke haze -->
    <div class="bar-haze"></div>

    <!-- Bartender - detailed figure -->
    <div class="ch bart idle" id="npc-bartender" style="left:42%;bottom:36%" data-npc="bartender">
        <div class="bart-head">
            <div class="bart-skull">
                <div class="bart-hair"></div>
                <div class="bart-eyes"><div class="bart-eye"></div><div class="bart-eye"></div></div>
                <div class="bart-nose"></div>
                <div class="bart-mouth"></div>
            </div>
        </div>
        <div class="bart-body">
            <div class="bart-shirt"></div>
            <div class="bart-vest"></div>
            <div class="bart-apron"></div>
        </div>
        <div class="bart-arm bart-arm-l"></div>
        <div class="bart-arm bart-arm-r"></div>
        <div class="bart-towel"></div>
        <span class="ipip">?</span>
    </div>

    <!-- Lipstick glass - SVG -->
    <div class="hotspot" id="obj-glass" data-look="glass" style="bottom:35%;left:62%;width:18px;height:28px">
        <svg viewBox="0 0 18 28" width="18" height="28">
            <path d="M4,2 L3,18 Q3,20 5,20 L13,20 Q15,20 15,18 L14,2 Z" fill="rgba(200,190,170,.15)" stroke="rgba(200,190,170,.25)" stroke-width=".5"/>
            <rect x="4" y="10" width="10" height="8" fill="rgba(180,140,80,.08)" rx="1"/>
            <rect x="3" y="8" width="11" height="3" rx="1" fill="rgba(180,30,30,.4)"/>
            <rect x="7" y="20" width="4" height="4" fill="rgba(200,190,170,.2)"/>
            <ellipse cx="9" cy="25" rx="6" ry="1.5" fill="rgba(200,190,170,.18)"/>
        </svg>
        <span class="ipip" style="top:-18px">!</span>
    </div>

    <button class="exit-btn" data-exit="street">EXIT</button>
</div>

<!-- ============ PI OFFICE ============ -->
<div id="sc-office" class="scene">
    <div class="off-wall"></div>
    <div class="off-molding"></div>
    <div class="off-baseboard"></div>

    <!-- Window with individual blind slats -->
    <div class="off-win">
        <div class="blinds">
            <div class="blind-slat"></div><div class="blind-slat"></div><div class="blind-slat"></div>
            <div class="blind-slat"></div><div class="blind-slat"></div><div class="blind-slat"></div>
            <div class="blind-slat"></div><div class="blind-slat"></div><div class="blind-slat"></div>
            <div class="blind-slat"></div><div class="blind-slat"></div><div class="blind-slat"></div>
            <div class="blind-slat"></div><div class="blind-slat"></div><div class="blind-slat"></div>
        </div>
    </div>
    <div class="light-rays"></div>

    <!-- Dust motes in the light -->
    <div class="dust-mote" style="top:15%;right:18%"></div>
    <div class="dust-mote" style="top:25%;right:22%;animation-delay:-1.5s"></div>
    <div class="dust-mote" style="top:35%;right:15%;animation-delay:-3s"></div>
    <div class="dust-mote" style="top:20%;right:25%;animation-delay:-4s;width:3px;height:3px"></div>
    <div class="dust-mote" style="top:45%;right:20%;animation-delay:-2s"></div>

    <!-- Bookshelf -->
    <div class="off-books">
        <div class="book" style="top:5%;height:20px;background:#4a2a15"></div>
        <div class="book" style="top:20%;height:18px;background:#2a3a2a"></div>
        <div class="book" style="top:35%;height:22px;background:#3a2020"></div>
        <div class="book" style="top:52%;height:16px;background:#2a2a3a"></div>
        <div class="book" style="top:65%;height:20px;background:#3a3020"></div>
        <div class="book" style="top:80%;height:18px;background:#1a2a2a"></div>
    </div>

    <!-- Hat rack with fedora -->
    <div class="hat-rack">
        <div class="hat"><div class="hat-crown"></div></div>
    </div>

    <!-- PI license on wall -->
    <div style="position:absolute;top:12%;left:22%;width:clamp(55px,10vw,75px);height:clamp(35px,7vw,50px);background:#e8e0d0;border:3px solid #3a3020;box-shadow:2px 2px 8px rgba(0,0,0,.4);padding:4px">
        <div style="font-family:'Playfair Display',serif;font-size:3px;color:#2a2015;text-align:center;font-weight:bold;border-bottom:1px solid #2a2015;padding-bottom:2px">STATE OF NEW YORK</div>
        <div style="font-family:'Special Elite',monospace;font-size:2.5px;color:#3a3025;text-align:center;margin-top:2px">PRIVATE INVESTIGATOR<br>LICENSE No. 4472<br>J. NOIR</div>
    </div>

    <!-- Desk -->
    <div class="off-desk">
        <!-- Scattered papers on desk -->
        <div style="position:absolute;top:-8px;left:65%;width:22px;height:28px;background:#e8e0d0;transform:rotate(3deg);box-shadow:1px 1px 3px rgba(0,0,0,.3)">
            <div style="margin:3px;height:1px;background:#aaa"></div>
            <div style="margin:3px;height:1px;background:#aaa;width:70%"></div>
            <div style="margin:3px;height:1px;background:#aaa;width:85%"></div>
        </div>
        <div style="position:absolute;top:-6px;left:68%;width:20px;height:26px;background:#e0d8c8;transform:rotate(-5deg);box-shadow:1px 1px 3px rgba(0,0,0,.3)"></div>
        <!-- Whiskey bottle and glass -->
        <div style="position:absolute;top:-18px;right:8%;width:10px;height:22px;background:linear-gradient(#4a2a10,#3a1a08);border-radius:2px 2px 0 0"></div>
        <div style="position:absolute;top:-10px;right:15%;width:8px;height:12px;background:rgba(200,180,140,.12);border:1px solid rgba(200,180,140,.15);border-radius:1px 1px 0 0"></div>
    </div>

    <div class="off-chair"><div class="ch-back"></div><div class="ch-seat"></div><div class="ch-legs"><div class="ch-leg"></div><div class="ch-leg"></div><div class="ch-leg"></div><div class="ch-leg"></div></div></div>

    <!-- Typewriter -->
    <div class="typewriter-cut" id="obj-typewriter" data-look="typewriter">
        <img src="https://upload.wikimedia.org/wikipedia/commons/thumb/a/a0/Underwoodfive.jpg/320px-Underwoodfive.jpg" alt="Underwood Typewriter" crossorigin="anonymous" onerror="this.style.display='none';this.parentElement.style.background='#1a1a1a';this.parentElement.style.borderRadius='5px 5px 0 0'">
        <span class="ipip">?</span>
    </div>

    <!-- Desk lamp -->
    <div class="desk-lamp"><div class="ls"></div><div class="la"></div><div class="la-base"></div><div class="lcone"></div></div>

    <!-- Filing cabinet -->
    <div class="off-filing" id="obj-filing" data-look="filing"><div class="fdr"></div><div class="fdr"></div><div class="fdr"></div><span class="ipip">?</span></div>

    <!-- Phone - SVG rotary -->
    <div class="hotspot" id="obj-phone-office" data-look="phone_office" style="bottom:33%;right:22%;width:35px;height:25px">
        <svg viewBox="0 0 35 25" width="35" height="25">
            <rect x="2" y="8" width="31" height="17" rx="3" fill="#1a1a1a"/>
            <circle cx="17" cy="16" r="7" fill="none" stroke="#333" stroke-width="1"/>
            <circle cx="17" cy="16" r="3" fill="#222"/>
            <path d="M4,8 Q4,2 10,2 L25,2 Q31,2 31,8" fill="#1a1a1a" stroke="#222" stroke-width=".5"/>
            <ellipse cx="8" cy="3" rx="5" ry="3" fill="#1a1a1a"/>
            <ellipse cx="27" cy="3" rx="5" ry="3" fill="#1a1a1a"/>
        </svg>
        <span class="ipip">?</span>
    </div>

    <!-- Floor and rug -->
    <div class="off-floor"></div>
    <div class="off-rug"></div>

    <button class="exit-btn" data-exit="street">EXIT</button>
</div>

<!-- ============ HOTEL LOBBY ============ -->
<div id="sc-hotel" class="scene">
    <div class="hotel-wall"></div>
    <div class="hotel-wains"></div>
    <div class="hotel-sign">AVALON HOTEL</div>

    <!-- Chandelier -->
    <div class="chandelier">
        <div class="ch-chain"></div>
        <div class="ch-hub"></div>
        <div class="ch-arm-el" style="left:10%;width:30%"></div>
        <div class="ch-arm-el" style="right:10%;width:30%"></div>
        <div class="ch-bulb-el" style="left:8%"></div>
        <div class="ch-bulb-el" style="right:8%"></div>
        <div class="ch-bulb-el" style="left:50%;transform:translateX(-50%)"></div>
        <div class="ch-glow"></div>
    </div>

    <!-- Key rack -->
    <div class="hotel-keys">
        <div class="key-hook" style="left:12%;top:18%" data-room="201">201</div>
        <div class="key-hook" style="left:25%;top:18%" data-room="208">208</div>
        <div class="key-hook empty" style="left:38%;top:18%" data-room="214">214</div>
        <div class="key-hook" style="left:51%;top:18%" data-room="220">220</div>
        <div class="key-hook" style="left:64%;top:18%" data-room="225">225</div>
        <div class="key-hook" style="left:77%;top:18%" data-room="228">228</div>
        <div class="key-hook" style="left:12%;top:55%" data-room="301">301</div>
        <div class="key-hook" style="left:25%;top:55%" data-room="305">305</div>
        <div class="key-hook" style="left:38%;top:55%" data-room="310">310</div>
        <div class="key-hook" style="left:51%;top:55%" data-room="315">315</div>
        <div class="key-hook" style="left:64%;top:55%" data-room="318">318</div>
        <div class="key-hook" style="left:77%;top:55%" data-room="322">322</div>
    </div>

    <!-- Front desk -->
    <div class="hotel-desk"></div>

    <!-- Desk bell - SVG -->
    <div class="desk-bell">
        <svg viewBox="0 0 14 12" width="14" height="12">
            <ellipse cx="7" cy="10" rx="6" ry="2" fill="#8a7a50"/>
            <path d="M3,10 Q3,4 7,3 Q11,4 11,10" fill="#a09060"/>
            <circle cx="7" cy="3" r="1.5" fill="#c0b080"/>
        </svg>
    </div>

    <!-- Columns -->
    <div class="hotel-column" style="left:8%;height:55%"><div class="hotel-col-cap"></div></div>
    <div class="hotel-column" style="right:8%;height:55%"><div class="hotel-col-cap"></div></div>

    <!-- Paintings on wall - use Gottlieb photo -->
    <div class="hotel-painting" style="top:14%;left:3%;width:clamp(45px,9vw,65px);height:clamp(35px,7vw,50px)">
        <img src="https://upload.wikimedia.org/wikipedia/commons/thumb/a/a4/Gottlieb_52nd_Street.jpg/240px-Gottlieb_52nd_Street.jpg" alt="" style="width:100%;height:100%;object-fit:cover;filter:grayscale(70%) sepia(50%) brightness(.35)" crossorigin="anonymous">
    </div>
    <div class="hotel-painting" style="top:16%;right:3%;width:clamp(50px,10vw,70px);height:clamp(40px,8vw,55px)">
        <div style="width:100%;height:100%;background:linear-gradient(135deg,#2a1a15,#1a0e08,#2a1a15);background-image:radial-gradient(ellipse at 40% 50%,rgba(180,140,80,.08),transparent 50%)"></div>
    </div>

    <!-- Potted plants -->
    <div class="lobby-plant" style="left:4%">
        <div class="plant-leaf" style="bottom:18px;left:8px;transform:rotate(-20deg)"></div>
        <div class="plant-leaf" style="bottom:18px;left:10px;transform:rotate(15deg)"></div>
        <div class="plant-leaf" style="bottom:20px;left:6px;transform:rotate(-35deg);height:14px"></div>
        <div class="plant-leaf" style="bottom:20px;left:12px;transform:rotate(30deg);height:14px"></div>
        <div class="plant-pot"></div>
    </div>
    <div class="lobby-plant" style="right:4%">
        <div class="plant-leaf" style="bottom:18px;left:8px;transform:rotate(-15deg)"></div>
        <div class="plant-leaf" style="bottom:18px;left:10px;transform:rotate(20deg)"></div>
        <div class="plant-leaf" style="bottom:20px;left:6px;transform:rotate(-30deg);height:14px"></div>
        <div class="plant-pot"></div>
    </div>

    <!-- Carpet -->
    <div class="hotel-carpet"></div>

    <!-- Hotel Clerk - detailed figure -->
    <div class="ch idle" id="npc-clerk" style="left:42%;bottom:33%" data-npc="clerk">
        <div style="width:clamp(44px,7vw,55px);height:clamp(105px,17vw,130px);position:relative">
            <!-- Head -->
            <div style="position:absolute;top:0;left:50%;transform:translateX(-50%);width:50%;height:16%">
                <div style="width:100%;height:75%;background:linear-gradient(to bottom,#b09070,#987858);border-radius:40% 40% 35% 35%"></div>
                <div style="position:absolute;top:2%;left:10%;width:80%;height:20%;background:#2a1a10;border-radius:50% 50% 0 0"></div>
                <div style="position:absolute;top:35%;left:22%;width:5px;height:4px;background:#1a1a1a;border-radius:50%"></div>
                <div style="position:absolute;top:35%;right:22%;width:5px;height:4px;background:#1a1a1a;border-radius:50%"></div>
                <div style="position:absolute;top:55%;left:40%;width:20%;height:4px;background:#907050;border-radius:1px"></div>
            </div>
            <!-- Body -->
            <div style="position:absolute;top:16%;left:8%;width:84%;height:84%;background:linear-gradient(to bottom,#2a2828,#1a1818);clip-path:polygon(15% 0%,85% 0%,90% 8%,92% 30%,90% 100%,10% 100%,8% 30%,10% 8%)">
                <div style="position:absolute;top:5%;left:30%;width:40%;height:25%;background:#d8d0c0"></div>
                <div style="position:absolute;top:0%;left:15%;width:70%;height:60%;background:linear-gradient(to bottom,#2a2828,#222);clip-path:polygon(10% 0%,90% 0%,100% 100%,0% 100%)"></div>
                <div style="position:absolute;top:5%;left:40%;width:20%;height:15%;background:#8a1a1a;clip-path:polygon(50% 0%,100% 100%,0% 100%)"></div>
            </div>
        </div>
        <span class="ipip">?</span>
    </div>

    <!-- Guest register -->
    <div class="hotspot" id="obj-register" data-look="register" style="bottom:33%;left:32%;width:55px;height:10px;background:linear-gradient(to bottom,#e8e0d0,#d8d0c0);box-shadow:1px 2px 4px rgba(0,0,0,.4);border-radius:1px">
        <div style="position:absolute;top:2px;left:5px;width:40px;height:1px;background:#aaa"></div>
        <div style="position:absolute;top:5px;left:5px;width:30px;height:1px;background:#bbb"></div>
        <span class="ipip" style="top:-18px">!</span>
    </div>

    <!-- Staircase door -->
    <div class="door-zone" data-door="room214" data-label="STAIRCASE TO ROOM 214" style="top:52%;right:12%;width:clamp(30px,6vw,45px);height:clamp(60px,12vw,90px);background:linear-gradient(to bottom,#1a1510,#12100c);border:3px solid #2a2015;box-shadow:inset 0 0 10px rgba(0,0,0,.4)">
        <div style="position:absolute;top:45%;right:4px;width:4px;height:4px;background:#8a7a50;border-radius:50%"></div>
    </div>

    <button class="exit-btn" data-exit="street">EXIT</button>
</div>

<!-- ============ ROOM 214 ============ -->
<div id="sc-room" class="scene">
    <!-- Walls with faded floral wallpaper -->
    <div class="room-wall"></div>
    <div class="room-molding"></div>
    <div class="room-baseboard"></div>
    <div class="room-stain"></div>

    <!-- Police flashlight atmosphere -->
    <div class="room-flash"></div>

    <!-- Room number on wall -->
    <div style="position:absolute;top:4%;left:50%;transform:translateX(-50%);font-family:'Playfair Display',serif;font-size:clamp(10px,2.5vw,16px);color:#6a5a40;letter-spacing:4px;text-shadow:0 0 8px rgba(100,80,50,.15);opacity:.6">ROOM 214</div>

    <!-- Window with cross-panes and detailed curtains -->
    <div class="room-window">
        <div class="room-window-pane">
            <!-- Moonlit city silhouette visible through window -->
            <div style="position:absolute;bottom:0;left:0;width:100%;height:40%;background:#060a10">
                <div style="position:absolute;bottom:0;left:10%;width:15%;height:70%;background:#080c14"></div>
                <div style="position:absolute;bottom:0;left:30%;width:20%;height:55%;background:#070b12"></div>
                <div style="position:absolute;bottom:0;left:55%;width:12%;height:80%;background:#090d16"></div>
                <div style="position:absolute;bottom:0;left:72%;width:18%;height:45%;background:#080c14"></div>
            </div>
            <!-- Moon glow -->
            <div style="position:absolute;top:12%;right:18%;width:12px;height:12px;border-radius:50%;background:radial-gradient(circle at 40% 35%,#e8e0c8,#c8c0a0 50%,transparent);box-shadow:0 0 10px rgba(200,190,160,.15)"></div>
        </div>
        <div class="window-cross-h"></div>
        <div class="window-cross-v"></div>
    </div>

    <!-- Curtains with folds -->
    <div class="room-curtain" style="top:6%;right:calc(8% + clamp(110px,20vw,155px) - 5px);width:clamp(25px,4.5vw,35px)">
        <div class="curtain-fold" style="left:0;width:35%;background:linear-gradient(to right,#3a1515,#301010)"></div>
        <div class="curtain-fold" style="left:30%;width:40%;background:linear-gradient(to right,#2a0a0a,#3a1515)"></div>
        <div class="curtain-fold" style="right:0;width:35%;background:linear-gradient(to right,#301010,#2a0a0a)"></div>
        <div class="curtain-tie" style="right:-4px"></div>
        <div class="curtain-tassel" style="right:-3px"></div>
    </div>
    <div class="room-curtain" style="top:6%;right:6%;width:clamp(25px,4.5vw,35px)">
        <div class="curtain-fold" style="left:0;width:35%;background:linear-gradient(to right,#2a0a0a,#3a1515)"></div>
        <div class="curtain-fold" style="left:30%;width:40%;background:linear-gradient(to right,#3a1515,#301010)"></div>
        <div class="curtain-fold" style="right:0;width:35%;background:linear-gradient(to right,#301010,#2a0a0a)"></div>
        <div class="curtain-tie" style="left:-4px"></div>
        <div class="curtain-tassel" style="left:-3px"></div>
    </div>

    <!-- Moonlight rays and dust -->
    <div class="room-moonlight"></div>
    <div class="moon-dust" style="top:14%;right:15%"></div>
    <div class="moon-dust" style="top:22%;right:20%;animation-delay:-2s"></div>
    <div class="moon-dust" style="top:30%;right:12%;animation-delay:-4s;width:3px;height:3px"></div>

    <!-- Dresser with mirror -->
    <div class="room-dresser">
        <div class="dresser-mirror">
            <div style="position:absolute;top:10%;left:10%;width:30%;height:1px;background:rgba(255,250,240,.03);transform:rotate(-5deg)"></div>
        </div>
        <div class="dresser-body">
            <div class="dresser-drawer" style="top:8%"><div class="dresser-knob"></div></div>
            <div class="dresser-drawer" style="top:40%"><div class="dresser-knob"></div></div>
            <div class="dresser-drawer" style="top:72%"><div class="dresser-knob"></div></div>
        </div>
        <div class="dresser-leg" style="left:2px"></div>
        <div class="dresser-leg" style="right:2px"></div>
    </div>

    <!-- Painting above bed (askew - crime scene disruption) -->
    <div style="position:absolute;top:10%;left:26%;width:clamp(50px,10vw,70px);height:clamp(35px,7vw,50px);border:4px solid #3a2815;box-shadow:2px 2px 10px rgba(0,0,0,.5);transform:rotate(5deg);overflow:hidden">
        <div style="width:100%;height:100%;background:linear-gradient(135deg,#2a2018,#1a1510,#2a2018);background-image:radial-gradient(ellipse at 50% 50%,rgba(120,80,50,.06),transparent 60%)"></div>
    </div>

    <!-- Bed - detailed with headboard, rumpled sheets, pillows -->
    <div class="room-bed">
        <div class="bed-headboard"></div>
        <div class="bed-mattress">
            <!-- Pillows -->
            <div class="bed-pillow" style="left:5%">
                <div class="pillow-crease"></div>
            </div>
            <div class="bed-pillow-indent" style="left:28%">
                <div class="pillow-crease" style="top:45%"></div>
            </div>
            <div class="bed-pillow" style="right:5%">
                <div class="pillow-crease"></div>
            </div>
            <!-- Rumpled sheets -->
            <div class="bed-sheet">
                <div class="sheet-fold" style="top:10%;left:20%;width:60%;height:1px"></div>
                <div class="sheet-fold" style="top:30%;left:5%;width:40%;height:1px;transform:rotate(-2deg)"></div>
                <div class="sheet-fold" style="top:50%;left:35%;width:45%;height:1px;transform:rotate(1deg)"></div>
                <div class="sheet-fold" style="top:70%;left:10%;width:55%;height:1px;transform:rotate(-1deg)"></div>
                <div class="sheet-rumple" style="top:15%;left:40%;width:30px;height:15px"></div>
                <div class="sheet-rumple" style="top:40%;left:15%;width:25px;height:12px;opacity:.6"></div>
                <div class="sheet-rumple" style="top:60%;right:20%;width:20px;height:10px;opacity:.5"></div>
                <!-- Turned down corner -->
                <div style="position:absolute;top:0;right:0;width:20%;height:15%;background:linear-gradient(225deg,#e8e0d0,#d0c8b8);clip-path:polygon(100% 0%,0% 100%,100% 100%)"></div>
            </div>
        </div>
        <!-- Bed legs -->
        <div class="bed-leg" style="left:3%"></div>
        <div class="bed-leg" style="right:3%"></div>
    </div>

    <!-- Chalk outline - SVG body shape -->
    <div class="chalk-outline">
        <svg viewBox="0 0 130 65" width="100%" height="100%" style="overflow:visible">
            <path d="M30,5 C25,2 22,5 20,10 C18,15 18,18 20,20 C17,22 8,25 5,30 C2,35 3,38 8,38 C12,38 18,35 22,30 L25,25 C24,32 22,45 20,55 C18,60 16,62 12,63 C10,63 8,62 8,60 M25,25 C26,32 28,45 32,55 C35,60 38,62 42,63 C44,63 46,62 46,60 M20,20 C22,22 25,22 28,20 C32,18 35,18 38,20 C40,22 38,24 35,24 C30,24 25,22 22,20 M30,12 C32,8 38,8 40,12 C42,16 40,22 35,24 M35,24 C36,32 38,45 42,55" fill="none" stroke="rgba(255,255,255,.12)" stroke-width="1.5" stroke-dasharray="3,3" stroke-linecap="round"/>
        </svg>
    </div>

    <!-- Nightstand with lamp -->
    <div class="room-table">
        <div class="table-drawer"><div class="table-knob"></div></div>
        <div class="table-leg" style="left:3px"></div>
        <div class="table-leg" style="right:3px"></div>
    </div>

    <!-- Bedside lamp -->
    <div class="room-lamp">
        <div class="rl-shade"></div>
        <div class="rl-neck"></div>
        <div class="rl-base"></div>
        <div class="rl-pool"></div>
    </div>

    <!-- Phone on nightstand - SVG rotary -->
    <div class="hotspot" id="obj-phone" data-look="phone" style="bottom:37%;right:12%;width:30px;height:20px;z-index:6">
        <svg viewBox="0 0 30 20" width="30" height="20">
            <rect x="2" y="6" width="26" height="14" rx="3" fill="#1a1a1a"/>
            <circle cx="15" cy="13" r="5.5" fill="none" stroke="#2a2a2a" stroke-width=".8"/>
            <circle cx="15" cy="13" r="2.5" fill="#181818"/>
            <circle cx="10" cy="10" r="1" fill="#222"/>
            <circle cx="20" cy="10" r="1" fill="#222"/>
            <circle cx="12" cy="16" r="1" fill="#222"/>
            <circle cx="18" cy="16" r="1" fill="#222"/>
            <path d="M4,6 Q4,1 9,1 L21,1 Q26,1 26,6" fill="#1a1a1a" stroke="#1e1e1e" stroke-width=".3"/>
            <ellipse cx="7" cy="2" rx="4" ry="2.5" fill="#1a1a1a"/>
            <ellipse cx="23" cy="2" rx="4" ry="2.5" fill="#1a1a1a"/>
            <rect x="6" y="0" width="3" height="4" rx="1" fill="#181818"/>
            <rect x="21" y="0" width="3" height="4" rx="1" fill="#181818"/>
        </svg>
        <span class="ipip">?</span>
    </div>

    <!-- Evidence markers - tent style -->
    <div class="evidence-marker" id="ev-1" data-look="evidence1" style="bottom:25%;left:25%;animation-delay:-1s">
        <div class="ev-tent"><div class="ev-num">1</div></div>
        <span class="ipip" style="top:-14px">!</span>
    </div>
    <div class="evidence-marker" id="ev-2" data-look="evidence2" style="bottom:30%;left:55%;animation-delay:-2.5s">
        <div class="ev-tent"><div class="ev-num">2</div></div>
        <span class="ipip" style="top:-14px">!</span>
    </div>
    <div class="evidence-marker" id="ev-3" data-look="evidence3" style="bottom:22%;right:20%;animation-delay:-4s">
        <div class="ev-tent"><div class="ev-num">3</div></div>
        <span class="ipip" style="top:-14px">!</span>
    </div>

    <!-- Diary clue on nightstand -->
    <div class="hotspot" id="obj-diary" data-item="diary" style="bottom:38%;right:16%;width:24px;height:30px;z-index:6">
        <div style="width:100%;height:100%;background:linear-gradient(to bottom,#4a2020,#3a1515);border-radius:2px;box-shadow:1px 2px 5px rgba(0,0,0,.5);position:relative;overflow:hidden">
            <div style="position:absolute;top:0;left:0;width:4px;height:100%;background:linear-gradient(to right,#3a1010,#4a2020)"></div>
            <div style="position:absolute;top:15%;left:20%;width:65%;height:1px;background:rgba(200,180,140,.25)"></div>
            <div style="position:absolute;top:25%;left:20%;width:50%;height:1px;background:rgba(200,180,140,.18)"></div>
            <div style="position:absolute;top:35%;left:20%;width:55%;height:1px;background:rgba(200,180,140,.2)"></div>
            <div style="position:absolute;top:45%;left:20%;width:40%;height:1px;background:rgba(200,180,140,.15)"></div>
            <div style="position:absolute;top:55%;left:20%;width:60%;height:1px;background:rgba(200,180,140,.22)"></div>
            <div style="position:absolute;top:65%;left:20%;width:45%;height:1px;background:rgba(200,180,140,.17)"></div>
            <div style="font-family:'Playfair Display',serif;font-size:3px;color:rgba(200,180,140,.4);text-align:center;position:absolute;bottom:6%;left:0;width:100%;letter-spacing:1px">DIARY</div>
        </div>
        <span class="ipip" style="top:-18px">!</span>
    </div>

    <!-- Overturned chair near bed -->
    <div style="position:absolute;bottom:16%;left:68%;width:24px;height:35px;transform:rotate(75deg);z-index:4">
        <div style="width:20px;height:18px;background:linear-gradient(to bottom,#3a2815,#2a1a0e);border-radius:3px 3px 0 0;border:1px solid #4a3520"></div>
        <div style="width:22px;height:5px;background:#2a1a0e;margin-top:1px"></div>
        <div style="display:flex;justify-content:space-between;width:20px;margin:0 auto">
            <div style="width:2px;height:10px;background:#2a1a0e"></div>
            <div style="width:2px;height:10px;background:#2a1a0e"></div>
        </div>
    </div>

    <!-- Glass on floor (broken) -->
    <div style="position:absolute;bottom:17%;left:48%;width:12px;height:8px;z-index:4;pointer-events:none">
        <svg viewBox="0 0 12 8" width="12" height="8">
            <path d="M1,1 L3,7 L5,5 L7,7 L9,3 L11,6 L10,1 Z" fill="rgba(200,200,210,.08)" stroke="rgba(200,200,210,.12)" stroke-width=".3"/>
            <line x1="2" y1="3" x2="5" y2="2" stroke="rgba(200,200,210,.06)" stroke-width=".2"/>
        </svg>
    </div>

    <!-- Spilled water/liquid near glass -->
    <div style="position:absolute;bottom:16.5%;left:46%;width:20px;height:8px;background:radial-gradient(ellipse,rgba(80,90,100,.06),transparent);border-radius:50%;pointer-events:none"></div>

    <!-- Crime scene tape -->
    <div class="room-tape">
        <div class="tape-strip" style="top:28%;left:-5%;width:110%;transform:rotate(2deg)">
            <div class="tape-text">CRIME SCENE DO NOT CROSS &nbsp; CRIME SCENE DO NOT CROSS &nbsp; CRIME SCENE DO NOT CROSS</div>
        </div>
        <div class="tape-strip" style="top:48%;left:-5%;width:110%;transform:rotate(-1.5deg)">
            <div class="tape-text">POLICE LINE DO NOT CROSS &nbsp; POLICE LINE DO NOT CROSS &nbsp; POLICE LINE DO NOT CROSS</div>
        </div>
    </div>

    <!-- Floor and rug -->
    <div class="room-floor"></div>
    <div class="room-rug"></div>

    <!-- Dark atmosphere -->
    <div class="room-dark"></div>

    <button class="exit-btn" data-exit="hotel">EXIT</button>
</div>

<!-- ============ UI ============ -->
<div id="ui">
    <div id="ltitle"></div>
    <div id="dlg"><div class="ds"></div><div class="dt"></div><div class="dc">tap to continue</div></div>
    <div id="inv"></div>
    <button id="case-btn">CASE NOTES</button>
    <div id="case-panel"><span class="close-x">&times;</span><h2>CASE NOTES</h2><div id="notes-list"></div></div>
    <div id="hint">CLICK TO MOVE &bull; CLICK OBJECTS TO INTERACT</div>
</div>
<div id="vig"></div><div id="grain"></div>

<!-- TITLE -->
<div id="title">
    <div class="tcol"><img src="https://upload.wikimedia.org/wikipedia/commons/thumb/a/a4/Gottlieb_52nd_Street.jpg/1280px-Gottlieb_52nd_Street.jpg" alt="" crossorigin="anonymous"></div>
    <h1>NIGHTFALL</h1>
    <div class="sub">A COLLAGE NOIR</div>
    <div class="tag">A woman is dead. The police say suicide.<br>Her sister says murder. You say fifty a day plus expenses.</div>
    <div class="tap">TAP TO BEGIN</div>
    <div class="yr">1 9 5 9</div>
</div>
</div>

<script>
// ==========================================
// GAME ENGINE
// ==========================================
const G = {
    scene: 'street',
    px: 16,
    inv: [],
    flags: {},
    notes: [],
    dq: [],
    di: 0,
    moving: false
};

// ==========================================
// DIALOGUE DATABASE
// ==========================================
const D = {
    vivian_intro: [
        {s:"???",t:"You must be the detective. I\u2019ve heard you take cases the police won\u2019t touch."},
        {s:"VIVIAN MARLOWE",t:"My name is Vivian. My sister Eleanor was found dead this morning at the Avalon Hotel. Room 214."},
        {s:"VIVIAN",t:"They\u2019re calling it suicide. Eleanor would never do that. She was afraid of something\u2014someone."},
        {s:"VIVIAN",t:"I need you to find who really killed her. I\u2019ll pay whatever it takes."},
        {s:"YOU",t:"Who were her friends? Enemies?"},
        {s:"VIVIAN",t:"Start at the Blue Moon bar. She spent her last evening there. Ask for a man called Mickey."},
        {s:"VIVIAN",t:"And detective\u2014be careful. Eleanor told me she was being followed."}
    ],
    vivian_return: [
        {s:"VIVIAN",t:"Have you spoken to Mickey yet?"},
        {s:"YOU",t:"Working on it. These things take time, Miss Marlowe."},
        {s:"VIVIAN",t:"Time is something Eleanor doesn\u2019t have anymore."}
    ],
    vivian_progress: [
        {s:"VIVIAN",t:"What have you found?"},
        {s:"YOU",t:"Your sister was meeting someone at the Blue Moon. Big man, gray suit. Works for someone named Castellano."},
        {s:"VIVIAN",t:"Castellano\u2026 Eleanor mentioned that name. She was terrified of him."},
        {s:"VIVIAN",t:"He runs half the waterfront. Real estate, shipping. The kind of man who makes problems disappear."},
        {s:"YOU",t:"Including your sister?"},
        {s:"VIVIAN",t:"Find the proof, detective. That\u2019s what I\u2019m paying you for."}
    ],
    bartender_intro: [
        {s:"MICKEY",t:"What can I get ya?"},
        {s:"YOU",t:"Information. I\u2019m looking into the Marlowe case."},
        {s:"MICKEY",t:"Eleanor? She was in here last night. Looked scared. Kept watching the door."},
        {s:"MICKEY",t:"She was meeting someone. Big guy, gray suit. Expensive. They argued."},
        {s:"YOU",t:"You get a name?"},
        {s:"MICKEY",t:"Didn\u2019t catch one. But he dropped a business card when he left. I still got it."},
        {s:"MICKEY",t:"Here. \u2018Vincent Castellano \u2013 Castellano Holdings.\u2019 Guy\u2019s connected. Watch your back."}
    ],
    bartender_return: [
        {s:"MICKEY",t:"Still working that case?"},
        {s:"YOU",t:"Castellano. Where do I find him?"},
        {s:"MICKEY",t:"You don\u2019t find Castellano. He finds you. That\u2019s usually bad news."},
        {s:"MICKEY",t:"But his office is on the fifth floor of the Harbor Building. Downtown."}
    ],
    bartender_late: [
        {s:"MICKEY",t:"You look like a man who\u2019s seen a ghost."},
        {s:"YOU",t:"Worse. I\u2019ve seen the truth."},
        {s:"MICKEY",t:"That\u2019ll do it. Drink?"}
    ],
    clerk_intro: [
        {s:"HOTEL CLERK",t:"Can I help you, sir?"},
        {s:"YOU",t:"I\u2019m investigating the death in room 214. Eleanor Marlowe."},
        {s:"CLERK",t:"The police already came and went. Said it was suicide. Case closed."},
        {s:"YOU",t:"I\u2019m not the police. Her sister hired me. I need to see that room."},
        {s:"CLERK",t:"I\u2019m not supposed to let anyone up there\u2026"},
        {s:"YOU",t:"Twenty dollars says you can make an exception."},
        {s:"CLERK",t:"\u2026Second floor. End of the hall on the right. The key\u2019s missing but the door\u2019s unlocked. Police were sloppy."}
    ],
    clerk_return: [
        {s:"CLERK",t:"Find what you were looking for up there?"},
        {s:"YOU",t:"Still looking. Did anyone visit her that night?"},
        {s:"CLERK",t:"A man came in around 10 PM. Big. Gray suit. Didn\u2019t sign the register."},
        {s:"CLERK",t:"He left about an hour later. Walking fast. Didn\u2019t look at me."}
    ],
    car: [
        {s:"NARRATOR",t:"A \u201957 Bel Air. Chrome catching neon like fresh blood on a switchblade."},
        {s:"NARRATOR",t:"Someone parked in a hurry. The door\u2019s not quite closed. Expensive shoes scuffed the running board."}
    ],
    newspaper: [
        {s:"NARRATOR",t:"Today\u2019s Daily Herald. Front page: \u2018WOMAN FOUND DEAD AT AVALON HOTEL.\u2019"},
        {s:"NARRATOR",t:"Police calling it suicide. Funny how suicides don\u2019t usually have bruises on their wrists."}
    ],
    matchbook: [
        {s:"NARRATOR",t:"A matchbook. \u2018The Blue Moon\u2019 in gold on crimson."},
        {s:"NARRATOR",t:"Barely damp. Dropped tonight. Someone was here recently who knows the bar."}
    ],
    hotel_locked: [
        {s:"NARRATOR",t:"The Avalon Hotel. Room 214 is up there somewhere behind dark curtains."},
        {s:"NARRATOR",t:"I\u2019ll need to talk to someone to get inside. Maybe try the bar first."}
    ],
    hotel_open: [
        {s:"NARRATOR",t:"The Avalon Hotel. The clerk might let me in now that I know what I\u2019m looking for."}
    ],
    typewriter: [
        {s:"NARRATOR",t:"My old Underwood. The \u2018e\u2019 key sticks, but it still tells the truth."},
        {s:"NARRATOR",t:"Half-finished case reports. Unpaid bills. A bottle of rye in the drawer."}
    ],
    filing: [
        {s:"NARRATOR",t:"Case files. Most of them cold. Just like the trails that led nowhere."},
        {s:"NARRATOR",t:"Eleanor Marlowe\u2019s folder is empty. Time to change that."}
    ],
    phone_office: [
        {s:"NARRATOR",t:"The phone. Dead line. Nobody\u2019s calling with good news at this hour."}
    ],
    glass: [
        {s:"NARRATOR",t:"A whiskey glass with lipstick on the rim. Deep red. Eleanor\u2019s shade."},
        {s:"NARRATOR",t:"She was sitting right here, hours before she died. The stool\u2019s still warm."}
    ],
    register: [
        {s:"NARRATOR",t:"The guest register. Eleanor checked in two days ago. Room 214."},
        {s:"NARRATOR",t:"No visitors logged. But the ink on last night\u2019s entries is smudged. Someone tore out a page."}
    ],
    phone: [
        {s:"NARRATOR",t:"Hotel phone. The receiver is off the hook."},
        {s:"NARRATOR",t:"The last number dialed is still on the rotary. A downtown exchange. Castellano\u2019s office."}
    ],
    evidence1: [
        {s:"NARRATOR",t:"Marker 1. A single earring. Pearl. Expensive. Ripped from the lobe."},
        {s:"NARRATOR",t:"This wasn\u2019t suicide. This was a struggle."}
    ],
    evidence2: [
        {s:"NARRATOR",t:"Marker 2. Scuff marks on the hardwood. Two sets of shoes. One large, one small."},
        {s:"NARRATOR",t:"Someone dragged her. The smaller prints lead to the window."}
    ],
    evidence3: [
        {s:"NARRATOR",t:"Marker 3. A cufflink under the nightstand. Monogrammed. \u2018V.C.\u2019"},
        {s:"NARRATOR",t:"Vincent Castellano. He was here. And now Eleanor Marlowe is dead."}
    ],
    diary: [
        {s:"NARRATOR",t:"A leather diary. Eleanor\u2019s handwriting."},
        {s:"NARRATOR",t:"\u2018V. won\u2019t stop calling. He says if I talk to anyone about the Harbor deal, I\u2019ll regret it.\u2019"},
        {s:"NARRATOR",t:"\u2018I told Vivian to hire someone if anything happens to me. Someone who can\u2019t be bought.\u2019"},
        {s:"NARRATOR",t:"The last entry is dated yesterday. The ink is still fresh. She knew she was in danger."}
    ],
    room214_locked: [
        {s:"NARRATOR",t:"Room 214. The door is closed. I need to talk to the clerk first."}
    ],
    case_solved: [
        {s:"NARRATOR",t:"The cufflink. The diary. The phone records. The witness at the bar. The torn register page."},
        {s:"NARRATOR",t:"Vincent Castellano killed Eleanor Marlowe because she knew about the Harbor deal."},
        {s:"NARRATOR",t:"Not suicide. Murder. And now I have enough to prove it."},
        {s:"NARRATOR",t:"Time to make a phone call to someone at the Herald who isn\u2019t on Castellano\u2019s payroll."},
        {s:"NARRATOR",t:"Eleanor Marlowe deserved better than a chalk outline and a closed case."},
        {s:"NARRATOR",t:"CASE CLOSED."}
    ]
};

// ==========================================
// DOM
// ==========================================
const $ = id => document.getElementById(id);
const player = $('player');
const dlg = $('dlg');
const loc = $('ltitle');

// ==========================================
// SCENE MANAGEMENT
// ==========================================
function goScene(id) {
    document.querySelectorAll('.scene').forEach(s => s.classList.remove('active'));
    const el = $('sc-' + id);
    if (!el) return;
    el.classList.add('active');
    G.scene = id;
    const names = {
        street: 'MAIN STREET',
        bar: 'THE BLUE MOON',
        office: 'NOIR INVESTIGATIONS',
        hotel: 'AVALON HOTEL',
        room: 'ROOM 214'
    };
    showLoc(names[id] || id.toUpperCase());
}

function showLoc(name) {
    loc.textContent = name;
    loc.classList.add('show');
    setTimeout(() => loc.classList.remove('show'), 3000);
}

// ==========================================
// PLAYER MOVEMENT
// ==========================================
function movePlayer(tx, cb) {
    if (G.moving) return;
    const dx = Math.abs(tx - G.px);
    if (dx < 2) { if (cb) cb(); return; }
    G.moving = true;
    player.classList.replace('idle', 'walking');
    player.style.transform = tx < G.px ? 'scaleX(-1)' : 'scaleX(1)';
    const ms = dx * 28;
    player.style.transition = 'left ' + ms + 'ms linear';
    player.style.left = tx + '%';
    G.px = tx;
    setTimeout(() => {
        G.moving = false;
        player.classList.replace('walking', 'idle');
        player.style.transition = '';
        if (cb) cb();
    }, ms);
}

// ==========================================
// DIALOGUE
// ==========================================
function talk(key, afterFn) {
    if (!D[key]) return;
    G.dq = D[key];
    G.di = 0;
    G._afterTalk = afterFn || null;
    showLine();
}

function showLine() {
    if (G.di >= G.dq.length) { closeDlg(); return; }
    const l = G.dq[G.di];
    dlg.querySelector('.ds').textContent = l.s;
    dlg.querySelector('.dt').textContent = l.t;
    dlg.classList.add('vis');
}

function advDlg() { G.di++; showLine(); }

function closeDlg() {
    dlg.classList.remove('vis');
    G.dq = []; G.di = 0;
    document.querySelectorAll('.talking').forEach(e => { e.classList.remove('talking'); e.classList.add('idle'); });
    if (G._afterTalk) { const fn = G._afterTalk; G._afterTalk = null; fn(); }
    checkCaseSolved();
}

// ==========================================
// NPC INTERACTION
// ==========================================
function talkNPC(id) {
    const el = $(id);
    if (!el) return;
    el.classList.remove('idle');
    el.classList.add('talking');
    const npc = el.dataset.npc;

    if (npc === 'vivian') {
        if (!G.flags.met_vivian) {
            talk('vivian_intro', () => { addNote('Vivian Marlowe hired me to investigate her sister Eleanor\u2019s death at the Avalon Hotel.'); addNote('Eleanor was found dead in Room 214. Police say suicide.'); addNote('Vivian says: start at the Blue Moon bar, ask for Mickey.'); });
            G.flags.met_vivian = true;
        } else if (G.flags.talked_bart) {
            talk('vivian_progress', () => { addNote('Vivian confirms: Castellano runs the waterfront. Eleanor was terrified of him.'); });
        } else {
            talk('vivian_return');
        }
    }
    else if (npc === 'bartender') {
        if (!G.flags.talked_bart) {
            talk('bartender_intro', () => { addNote('Mickey says Eleanor was at the bar last night. Scared. Meeting a big man in a gray suit.'); addNote('Business card found: Vincent Castellano \u2013 Castellano Holdings.'); G.flags.hotel_access = true; });
            G.flags.talked_bart = true;
        } else if (G.flags.found_cufflink) {
            talk('bartender_late');
        } else {
            talk('bartender_return', () => { addNote('Mickey says Castellano\u2019s office is in the Harbor Building, 5th floor.'); });
        }
    }
    else if (npc === 'clerk') {
        if (!G.flags.talked_clerk) {
            if (!G.flags.talked_bart) {
                talk('hotel_locked');
                return;
            }
            talk('clerk_intro', () => { addNote('Hotel clerk let me into Room 214 for $20.'); addNote('Key to 214 is missing. Door unlocked. Police were sloppy.'); G.flags.room_access = true; });
            G.flags.talked_clerk = true;
        } else {
            talk('clerk_return', () => { addNote('Clerk confirms: a big man in a gray suit visited Eleanor around 10 PM. Left an hour later. Walking fast.'); });
        }
    }
}

// ==========================================
// COLLECTIBLES & LOOKABLES
// ==========================================
function collect(el, itemId) {
    if (G.inv.includes(itemId)) return;
    G.inv.push(itemId);
    el.style.transition = 'opacity .5s,transform .5s';
    el.style.opacity = '0';
    el.style.transform = 'scale(.5) rotate(10deg)';
    setTimeout(() => el.style.display = 'none', 500);
    talk(itemId, () => {
        if (itemId === 'newspaper') addNote('Newspaper: Eleanor Marlowe found dead. \u201cSuicide.\u201d Bruises on wrists suggest otherwise.');
        if (itemId === 'matchbook') addNote('Blue Moon matchbook found on the street. Dropped recently.');
        if (itemId === 'diary') { addNote('Eleanor\u2019s diary: Castellano threatened her about the \u201cHarbor deal.\u201d'); addNote('Eleanor told Vivian to hire someone if anything happened. She knew she was in danger.'); G.flags.found_diary = true; }
    });
    renderInv();
}

function lookAt(key) {
    talk(key, () => {
        if (key === 'glass') { addNote('Lipstick on whiskey glass at the bar. Eleanor was here.'); G.flags.found_glass = true; }
        if (key === 'register') { addNote('Hotel register: Eleanor checked in 2 days ago. Last night\u2019s page torn out.'); G.flags.found_register = true; }
        if (key === 'phone') { addNote('Hotel phone off the hook. Last number dialed: Castellano\u2019s office.'); G.flags.found_phone = true; }
        if (key === 'evidence1') { addNote('Evidence #1: Pearl earring ripped from earlobe. This was a struggle, not suicide.'); G.flags.found_earring = true; }
        if (key === 'evidence2') { addNote('Evidence #2: Two sets of shoe scuffs. Someone dragged her toward the window.'); G.flags.found_scuffs = true; }
        if (key === 'evidence3') { addNote('Evidence #3: Cufflink monogrammed \u201cV.C.\u201d \u2014 Vincent Castellano was in this room.'); G.flags.found_cufflink = true; }
    });
}

function renderInv() {
    const el = $('inv');
    el.innerHTML = '';
    const icons = { newspaper:'\u{1F4F0}', matchbook:'\u{1F525}', diary:'\u{1F4D5}' };
    G.inv.forEach(i => {
        const d = document.createElement('div');
        d.className = 'inv-slot';
        d.textContent = icons[i] || '?';
        d.title = i;
        el.appendChild(d);
    });
}

// ==========================================
// CASE NOTES
// ==========================================
function addNote(text) {
    if (G.notes.includes(text)) return;
    G.notes.push(text);
    renderNotes();
}

function renderNotes() {
    const el = $('notes-list');
    el.innerHTML = '';
    G.notes.forEach(n => {
        const d = document.createElement('div');
        d.className = 'cnote';
        d.textContent = n;
        el.appendChild(d);
    });
}

// ==========================================
// WIN CONDITION
// ==========================================
function checkCaseSolved() {
    if (G.flags.case_solved) return;
    if (G.flags.found_cufflink && G.flags.found_diary && G.flags.found_phone) {
        G.flags.case_solved = true;
        setTimeout(() => {
            talk('case_solved', () => {
                addNote('\u2014\u2014\u2014 CASE CLOSED \u2014\u2014\u2014');
                addNote('Vincent Castellano murdered Eleanor Marlowe to silence her about the Harbor real estate deal.');
                addNote('Evidence: cufflink, diary, phone records, witness testimony, torn hotel register.');
            });
        }, 1000);
    }
}

// ==========================================
// INPUT SETUP
// ==========================================
function init() {
    // Title
    $('title').addEventListener('click', () => {
        $('title').classList.add('gone');
        showLoc('MAIN STREET');
        setTimeout(() => $('hint').style.opacity = '0', 6000);
    });

    // Street click-to-move
    $('sc-street').addEventListener('click', e => {
        if (dlg.classList.contains('vis')) { advDlg(); return; }
        const r = $('sc-street').getBoundingClientRect();
        const x = ((e.clientX - r.left) / r.width) * 100;
        movePlayer(Math.max(3, Math.min(93, x)));
    });

    // NPCs
    document.querySelectorAll('[data-npc]').forEach(n => {
        n.addEventListener('click', e => {
            e.stopPropagation();
            if (dlg.classList.contains('vis')) { advDlg(); return; }
            if (G.scene === 'street') {
                const nx = parseFloat(n.style.left);
                movePlayer(nx - 6, () => talkNPC(n.id));
            } else {
                talkNPC(n.id);
            }
        });
    });

    // Car
    $('obj-car').addEventListener('click', e => {
        e.stopPropagation();
        if (dlg.classList.contains('vis')) { advDlg(); return; }
        talk('car');
    });

    // Lookable objects
    document.querySelectorAll('[data-look]').forEach(o => {
        o.addEventListener('click', e => {
            e.stopPropagation();
            if (dlg.classList.contains('vis')) { advDlg(); return; }
            lookAt(o.dataset.look);
        });
    });

    // Collectible items
    document.querySelectorAll('[data-item]').forEach(c => {
        c.addEventListener('click', e => {
            e.stopPropagation();
            if (dlg.classList.contains('vis')) { advDlg(); return; }
            collect(c, c.dataset.item);
        });
    });

    // Doors & neon signs
    document.querySelectorAll('[data-door]').forEach(d => {
        d.addEventListener('click', e => {
            e.stopPropagation();
            if (dlg.classList.contains('vis')) { advDlg(); return; }
            const t = d.dataset.door;
            if (t === 'bar') goScene('bar');
            else if (t === 'office') goScene('office');
            else if (t === 'hotel') {
                if (G.flags.talked_bart) goScene('hotel');
                else talk('hotel_locked');
            }
            else if (t === 'room214') {
                if (G.flags.room_access) goScene('room');
                else talk('room214_locked');
            }
        });
    });

    // Key hooks in hotel
    document.querySelectorAll('.key-hook').forEach(k => {
        k.addEventListener('click', e => {
            e.stopPropagation();
            if (dlg.classList.contains('vis')) { advDlg(); return; }
            const room = k.dataset.room;
            if (room === '214') {
                if (G.flags.room_access) goScene('room');
                else talk('room214_locked');
            }
        });
    });

    // Exit buttons
    document.querySelectorAll('[data-exit]').forEach(b => {
        b.addEventListener('click', e => {
            e.stopPropagation();
            goScene(b.dataset.exit);
        });
    });

    // Dialogue advance
    dlg.addEventListener('click', e => { e.stopPropagation(); advDlg(); });

    // Interior clicks advance dialogue
    ['sc-bar','sc-office','sc-hotel','sc-room'].forEach(id => {
        $(id).addEventListener('click', e => {
            if (dlg.classList.contains('vis')) advDlg();
        });
    });

    // Case notes
    $('case-btn').addEventListener('click', e => {
        e.stopPropagation();
        $('case-panel').classList.toggle('vis');
    });
    $('case-panel').querySelector('.close-x').addEventListener('click', e => {
        e.stopPropagation();
        $('case-panel').classList.remove('vis');
    });

    // Keyboard
    document.addEventListener('keydown', e => {
        if (e.key === ' ' || e.key === 'Enter') { if (dlg.classList.contains('vis')) advDlg(); }
        if (e.key === 'Escape') { closeDlg(); $('case-panel').classList.remove('vis'); }
        if (e.key === 'n' || e.key === 'N') $('case-panel').classList.toggle('vis');
    });
}

init();
</script>
</body>
</html>
